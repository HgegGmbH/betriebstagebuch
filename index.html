<!-- 

    Code erstellt mit der Hilfe von: Safety Pig:
                            _
   _._ _..._ .-',     _.._(`))
  '-. `     '  /-._.-'    ',/
     )         \            '.
    / _    _    |             \
   |  a    a    /              |
   \   .-.     /               ;  
    '-('' ).-'       ,'       ;
       '-;           |      .'
          \           \    /
          | |  .__  _.-\   \
          | |  |  ``/  /`  /
         /,_|  |   /,_/   /
            /,_/      '`-'         

 -->

<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BETRIEBSTAGEBUCH</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap">

    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <link rel="icon" href="https://i.imgur.com/jUXw3Nh.png" type="image/x-icon">
    <link rel="shortcut icon" href="https://i.imgur.com/jUXw3Nh.png" type="image/x-icon">

    <link href='https://fonts.googleapis.com/css?family=Orbitron' rel='stylesheet' type='text/css'>

    <style>
        .Produkt {
            display: inline-block;
            vertical-align: top;
            border: 1px solid rgb(207, 207, 207);
            border-radius: 5px;
            width: 360px;
            padding: 10px;
            margin-right: 2px;
            margin-left: 2px;
            margin-top: 10px;
        }

        .checkbox-wrapper-4 * {
            box-sizing: border-box;
        }
        .checkbox-wrapper-4 .cbx {
            -webkit-user-select: none;
            user-select: none;
            cursor: pointer;
            padding: 6px 8px;
            border-radius: 6px;
            overflow: hidden;
            transition: all 0.2s ease;
            display: inline-block;
        }
        .checkbox-wrapper-4 .cbx:not(:last-child) {
            margin-right: 6px;
        }
        .checkbox-wrapper-4 .cbx:hover {
            background: rgba(0,119,255,0.06);
        }
        .checkbox-wrapper-4 .cbx span {
            float: left;
            vertical-align: middle;
            transform: translate3d(0, 0, 0);
        }
        .checkbox-wrapper-4 .cbx span:first-child {
            position: relative;
            width: 18px;
            height: 18px;
            border-radius: 4px;
            transform: scale(1);
            border: 1px solid #cccfdb;
            transition: all 0.2s ease;
            box-shadow: 0 1px 1px rgba(0,16,75,0.05);
        }
        .checkbox-wrapper-4 .cbx span:first-child svg {
            position: absolute;
            top: 3px;
            left: 2px;
            fill: none;
            stroke: #fff;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            stroke-dasharray: 16px;
            stroke-dashoffset: 16px;
            transition: all 0.3s ease;
            transition-delay: 0.1s;
            transform: translate3d(0, 0, 0);
        }
        .checkbox-wrapper-4 .cbx span:last-child {
            padding-left: 8px;
            line-height: 18px;
        }
        .checkbox-wrapper-4 .cbx:hover span:first-child {
            border-color: #07f;
        }
        .checkbox-wrapper-4 .inp-cbx {
            position: absolute;
            visibility: hidden;
        }
        .checkbox-wrapper-4 .inp-cbx:checked + .cbx span:first-child {
            background: #07f;
            border-color: #07f;
            animation: wave-4 0.4s ease;
        }
        .checkbox-wrapper-4 .inp-cbx:checked + .cbx span:first-child svg {
            stroke-dashoffset: 0;
        }
        .checkbox-wrapper-4 .inline-svg {
            position: absolute;
            width: 0;
            height: 0;
            pointer-events: none;
            user-select: none;
        }
        @media screen and (max-width: 640px) {
            .checkbox-wrapper-4 .cbx {
            width: 100%;
            display: inline-block;
            }
        }
        @-moz-keyframes wave-4 {
            50% {
            transform: scale(0.9);
            }
        }
        @-webkit-keyframes wave-4 {
            50% {
            transform: scale(0.9);
            }
        }
        @-o-keyframes wave-4 {
            50% {
            transform: scale(0.9);
            }
        }
        @keyframes wave-4 {
            50% {
            transform: scale(0.9);
            }
        }

        #dateTimeDialog {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.3);
            border-radius: 10px;
            text-align: center;
            color: black;
            font-size: larger;
        }
        #overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
        }
    </style>

    <script>
        function e(name)
        {
            return document.getElementById(name);
        }

        function Show(element)
        {
            element.style.display = "block"
        }

        function Hide(element)
        {
            element.style.display = "none"
        }

        var DatabaseURL = "https://betriebstagebuch-1a1bb-default-rtdb.firebaseio.com/";

        const firebaseApp = firebase.initializeApp(
        { 
            apiKey: "AIzaSyAds2u73hfXzV1dDhs_hAOE-oT18bmvXB0",
            authDomain: "betriebstagebuch-1a1bb.firebaseapp.com",
            databaseURL: DatabaseURL,
            projectId: "betriebstagebuch-1a1bb",
            storageBucket: "betriebstagebuch-1a1bb.appspot.com",
            messagingSenderId: "388367667302",
            appId: "1:388367667302:web:41fd1b4b05150014325da7"
        });

        const db = firebaseApp.firestore();
        const auth = firebaseApp.auth();

        var database;
        var dataRef;

        var IstAngemeldet = false;

        function InitBetriebstagebuch(PasswortBenutzereingabe)
        {        
            var email = "kohlberg068897@gmail.com";

            auth.signInWithEmailAndPassword(email, PasswortBenutzereingabe)
            .then((userCredential) =>
            {
                console.log("Anmeldung erfolgreich:", userCredential.user.uid);
                document.getElementById("GesamteWebseite").style.display = "block";
                //console.log(GetVariable("data/var1"));

                database = firebase.database();
                dataRef = database.ref();

                IstAngemeldet = true;

                document.getElementById("AnmeldungFenster").style.display = "none";
                document.getElementById("GesamteWebseite").style.display = "block";
                document.getElementById("AnmeldungFehlgeschlagen").style.display = "none";

                setCookie("PasswortBetriebstagebuch", PasswortBenutzereingabe)

                Event_AnmeldungAbgeschlossen();
            })
            .catch((error) => 
            {
                IstAngemeldet = false;

                document.getElementById("AnmeldungFenster").style.display = "none";
                document.getElementById("GesamteWebseite").style.display = "none";
                document.getElementById("AnmeldungFehlgeschlagen").style.display = "block";
            });
        }

        function Abmelden()
        {
            deleteCookie("PasswortBetriebstagebuch")
        }

        function GetVariable(Pfad)
        {
            return new Promise((resolve, reject) =>
            {
                dataRef.child(Pfad).once("value")
                    .then((snapshot) =>
                    {
                        const variableninhalt = snapshot.val();
                        resolve(variableninhalt);
                        console.log(`LESEN: ${Pfad}`);
                    })
                    .catch((error) =>
                    {
                        console.log("Fehler beim Lesen der Daten:", error.message);
                        reject(error);
                    });
            });
        }

        function SetVariable(Pfad, neuerWert)
        {
            return new Promise((resolve, reject) =>
            {
                dataRef.child(Pfad).set(neuerWert)
                    .then(() =>
                    {
                        console.log(`Erfolgr.geschrieben '${Pfad}', '${neuerWert}'`);
                        resolve();
                    })
                    .catch((error) =>
                    {
                        console.log("Fehler beim Schreiben der Daten:", error.message);
                        reject(error);
                    });
            });
        }

        function deleteVariable(Pfad)
        {
            return new Promise((resolve, reject) =>
            {
                dataRef.child(Pfad).remove()
                    .then(() =>
                    {
                        console.log(`Erfolgreich gelöscht: '${Pfad}'`);
                        resolve();
                    })
                    .catch((error) =>
                    {
                        console.log("Fehler beim Löschen der Daten:", error.message);
                        reject(error);
                    });
            });
        }

        function GetSubvariablen(Pfad)
        {
            return new Promise((resolve, reject) => {
                dataRef.child(Pfad).once("value")
                    .then((snapshot) => {
                        const data = snapshot.val();
                        if (data && typeof data === "object") {
                            const subVariablesList = Object.keys(data).map(subVar => `${Pfad}/${subVar}`);
                            resolve(subVariablesList);
                        } else {
                            resolve([]);
                        }
                    })
                    .catch((error) => {
                        console.log("Fehler beim Lesen der Daten:", error.message);
                        reject(error);
                    });
            });
        }

        function IstHandy()
        {
            return window.innerHeight > window.innerWidth;
        }

        function formatDate(date)
        {
            if (!(date instanceof Date))
            {
                return "Ungültiges Datum";
            }

            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');

            const formattedDate = `${day}.${month}.${year}`;

            return formattedDate;
        }

        function getZeitstempel()
        {
            return new Date().getTime();
        }

        function getFileName(path)
        {
            const segments = path.split('/');
            return segments[segments.length - 1];
        }

        function setCookie(name, value)
        {
            var expirationDate = new Date();
            expirationDate.setDate(expirationDate.getDate() + 30);

            document.cookie = name + "=" + value + "; expires=" + expirationDate.toUTCString() + "; path=/";
        }

        function getCookie(name)
        {
            var cookieName = name + "=";
            var cookies = document.cookie.split(';');

            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.indexOf(cookieName) === 0) {
                    return cookie.substring(cookieName.length, cookie.length);
                }
            }

            return null;
        }

        function deleteCookie(name)
        {
            document.cookie = name + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
        }

        function cookieExists(name)
        {
            return getCookie(name) !== null;
        }

        function extractParameter(ParameterName)
        {
            var urlParams = new URLSearchParams(window.location.search);
            var parameterValue = urlParams.get(ParameterName);
            return parameterValue;
        }
    </script>
</head>
<body style="background-color: rgb(36, 36, 36); color: rgb(218, 218, 218); ">
    



    

    <div class="container mt-5" id="AnmeldungFenster" style="display: none; text-align: center;"> 
        <strong style="font-size: 35pt; color: rgb(255, 255, 255);">Anmelden</strong><br><br>
        <label>Bitte das Passwort eingeben</label>
        <input type="password" class="form-control" id="PasswortTextBox" aria-describedby="basic-addon3" placeholder="Passwort eingeben"><br><br>
        <button type="button" onclick="InitBetriebstagebuch(document.getElementById('PasswortTextBox').value)" class="btn btn-primary">Anmelden</button>
    </div>

    <div class="container mt-5" id="AnmeldungFehlgeschlagen" style="display: none; text-align: center;"> 
        <strong style="font-size: 25pt; color: rgb(255, 255, 255);">Authentifizierung<br>fehlgeschlagen</strong><br><br>
        <button type="button" onclick="location.reload()" class="btn btn-danger">Erneut versuchen</button>
    </div>

    <div class="container mt-5" id="QRSCAN" style="display: none; text-align: center;">  
        <strong style="font-size: 25pt; color: rgb(255, 255, 255);" id="QRScanUeberschriftText">QR-CODE SCAN</strong><br><br>
        <button style="width: 100%;" class="btn btn-danger" onclick="QRSCAN_Abbrechen()">Scan Abbrechen</button>
        <br><br>
        <div id="qr-code-reader" style="width: 100%; height: 100%;"></div>
    </div>

    <div class="container mt-3" id="Wartungsberichte_Seite" style="display: none;">  

        <button style="width: 100%;" class="btn btn-danger" onclick="WartungsberichtSchliessen()">Wartungsberichte schließen</button>
        <br>
        
        <div id="WartungsberichteAuflistung">
            <!-- <br>
            <div style="background-color: white; color: rgb(40, 40, 40);">
                <div class="ml-5 mr-5 mt-4">
                    <br>
                    <strong>                    
                        <span style="color: rgb(47, 90, 125); font-size: 22pt;">HGEG WARTUNGSBERICHT</span><br>
                        <span style="color: rgb(47, 90, 125); font-size: 18pt;">Fahrzeuguntersuchtung / Reparatur</span><br>                    
                    
                        <div style="font-size: 13pt;">
                            <br>
                            Wartungsbericht vom 04.06.2024 um 17:33 &nbsp;|&nbsp; Wartungsbericht-Nr: 112833472348          
                            <br><br>  
    
                            <table class="table table-bordered">
                                <thead class="thead-light">
                                    <tr>
                                    <th scope="col">FAHRZEUG</th>
                                    <th scope="col">Fzg-Nummer</th>
                                    <th scope="col">BETREIBER</th>
                                    <th scope="col">EINGETRAGEN SEIT</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                    <td>Sworks Breitlenker</td>
                                    <td>12345123421354</td>
                                    <td>HGEG GmbH</td>
                                    <td>70.33.2156</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table class="table table-bordered">
                                <tbody>
                                    <tr>
                                        <td>Mangel Identifikationsnummer:</td>
                                        <td>12381237126234</td>
                                    </tr>
                                    <tr>
                                        <td>Mangel Beschreibung:</td>
                                        <td>Sitz locker in defektem Korb</td>
                                    </tr>
                                </tbody>
                            </table>
                            <br>
                            <span style="color: rgb(47, 90, 125); font-size: 18pt;">Anmerkungen</span><br>
    
                            Sitz wieder angeschraubt.<br>
                            Schraube war nicht gebrochen sondern nur locker.<br>
                            <br>
                            Keine weiteren Maßnahmen erforderlich.<br>
    
                            <br><br>
                            <span style="color: rgb(47, 90, 125); font-size: 18pt;">Mit freundlichen Grüßen</span><br>
                            HGEG GmbH Fahrzeugtechnik - Zentrale
                        </div>
                    </strong>
                </div>            
                <br>
            </div> -->
        </div>     
        <br><br><br><br>          
    </div>

    <div class="container mt-5" id="GesamteWebseite" style="display: none;">  
        <div id="overlay"></div>
        
        <div id="dateTimeDialog">
            <p>Datum und Uhrzeit auswählen:</p>
            <input type="datetime-local" id="datetimeInput">
            <br><br>

            <button onclick="confirmDateTime()" type="button" class="btn btn-success"><img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="24px" alt="">OK</button>
            <button style="margin-left: 4px;" onclick="closeDateTimePicker(); AktuellesPopUpDateObjekt = null" type="button" class="btn btn-danger"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-2" height="26px" alt="">Abbrechen</button><br>
        </div>
        
        <div class="form-group">
            <div class="row">

                <div class="ml-3" style="width: 80px; height: 80px;">
                    <img src="https://i.imgur.com/jUXw3Nh.png" style="width: 80px;" alt="">
                </div>
    
                <div class="ml-3">
                    <strong style="font-size: 18pt;"><strong>HGEG GmbH</strong><br>Betriebstagebuch</strong><br>
                </div>
    
            </div>

            <br>
            <hr style="background-color: white;">

            <button type="button" id="ButtonsHauptmenueAnzeigenButton" onclick="ButtonsHauptmenue.style.display = 'block'; ButtonsHauptmenueAnzeigenButton.style.display = 'none'" class="btn btn-primary"><img src="https://cdn-icons-png.flaticon.com/512/7746/7746114.png" class="mr-2" height="22px" alt="">Menü anzeigen</button>

            <div id="ButtonsHauptmenue" style="display: none;">
                <button type="button" onclick="Hauptmenue_Seite_ButtonClicked()" style="margin-bottom: 8px;" class="btn btn-primary"><img src="https://i.imgur.com/WNbc9AA.png" class="mr-2" height="22px" alt="">Hauptmenü</button>
                <button type="button" onclick="EintragHinzufuegen_Seite_ButtonClicked()" style="margin-left: 4px; margin-bottom: 8px;" class="btn btn-primary"><img src="https://i.imgur.com/WoPhKJy.png" class="mr-2" height="24px" alt="">Einsatz hinzufügen</button><br>
                <button onclick="Inventarsucher_Seite_ButtonClicked()" style="margin-bottom: 8px;" type="button" class="btn btn-light"><img src="https://i.imgur.com/k62MroZ.png" class="mr-2" height="24px" alt="">Inventarsucher</button>
                <button style="margin-left: 4px; margin-bottom: 8px;" onclick="ZeiterfassungSeiteButtonClicked()" type="button" class="btn btn-light"><img src="https://i.imgur.com/j2CymSX.png" class="mr-2" height="26px" alt="">Zeiterfassung</button><br>
                <button onclick="CodeGenerator_Seite_ButtonClicked()" style="margin-bottom: 8px;" type="button" class="btn btn-light"><img src="https://i.imgur.com/CWOWIhQ.png" class="mr-2" height="26px" alt="">Code Generator</button>
                <button style="margin-left: 4px; margin-bottom: 8px;" onclick="Statistik_ButtonClicked()" type="button" class="btn btn-light"><img src="https://i.imgur.com/TPgxiEc.png" class="mr-2" height="26px" alt="">Statistik</button><br>
                <button onclick="Aufgaben_ButtonClicked()" type="button" style="margin-bottom: 8px;" class="btn btn-light"><img src="https://i.imgur.com/jRDR3wY.png" class="mr-2" height="26px" alt="">Aufgaben</button>
                <button style="margin-left: 4px; margin-bottom: 8px;" onclick="Zugzeit_ButtonClicked()" type="button" class="btn btn-light"><img src="https://i.imgur.com/H4x1kwH.png" class="mr-2" height="26px" alt="">Bus / Zugzeit</button><br>
                <button onclick="Fahrzeug_ButtonClicked()" type="button" style="margin-bottom: 8px;" class="btn btn-light"><img src="https://i.imgur.com/NNCZcDZ.png" class="mr-2" height="26px" alt="">Fahrzeuge</button>
                <button type="button" style="margin-left: 4px; margin-bottom: 8px;" onclick="ReadQRCode('FzgBarcodeScanZwischenablage', false, 'Fzg-Barcode scannen')" class="btn btn-light"><img src="https://i.imgur.com/TONSd5l.png" class="mr-2" height="24px" alt="">Fzg Scan</button><br>
                <button onclick="location.href = LinkBetriebsvorschriftenHGEGSilgan" type="button" class="btn btn-light"><img src="https://storage.needpix.com/rsynced_images/paragraph-360093_1280.png" class="mr-2" height="26px" alt="">HGEG Silgan</button>
            </div>
            
            <hr style="background-color: white;"><br>

            <div id="Seite_AuflistungEinsaetze" style="display: block;">
                <strong style="font-size: 25pt;"><img src="https://i.imgur.com/3cAEXcj.png" height="42px" alt="">  Einsatz Auflistung</strong><br><br>


                <label for="datepicker">Datum:</label>
                <input type="date" onchange="ClearFlowLayoutPanel_Einsatzauflistung()" class="form-control" id="AusgewaehltesDatum" min="2023-08-01" placeholder="Datum auswählen"><br><br>
                <button type="button" onclick="ButtonEinsaetzeAnzeigenClicked()" class="btn btn-light">Einsätze anzeigen / aktualisieren</button>
                <br><br>
    
                <div id="FlowLayoutPanel_Einsatzauflistung">  
                    
                </div>
            </div>

            <div id="Seite_EintragHinzufuegen" style="display: none;">
                <strong style="font-size: 25pt;"><img src="https://i.imgur.com/WoPhKJy.png" height="42px" alt="">  Neuer Einsatz ...</strong><br><br>
                
                <label>Datum des Einsatzes ...</label>
                <input type="date" onchange="" class="form-control" id="AusgewaehltesDatumEintragHinzufuegen" min="2023-08-01" placeholder="Datum auswählen"><br>

                <label>Organisation (Herkunft der Beute) ...</label>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <label class="input-group-text" for="inputGroupSelect01" style="width: 120px;">Organisation</label>
                    </div>
                    <select class="custom-select" id="herkunftCombobox">
                        <option selected>Bitte auswählen ...</option>
                        <option value="Allgemein">HGEG-Allgemein</option>
                        <option value="Silgan">HGEG-Silgan</option>
                        <option value="Heinfels">HGEG-Heinfels</option>
                        <option value="Liftmull">HGEG-Liftmull</option>
                        <option value="ElektroAichner">HGEG-ElektroAichner</option>
                        <option value="Agetech">HGEG-Agetech</option>
                        <option value="PHTL">HGEG-PHTL</option>
                        <option value="Stauder">HGEG-Stauder</option>
                        <option value="Spezial">HGEG-Spezial</option>
                    </select>
                </div>

                <label>Anmerkungen / Zusatzinformationen zum Einsatz ...</label>
                <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="basic-addon3" style="width: 120px;">Anmerkungen</span>
                </div>
                <input type="text" class="form-control" id="AnmerkungenTextBox" aria-describedby="basic-addon3">
                </div><br>

                <strong>Anwesende Personen:</strong><br><br>
                <!-- <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="AndreasAnwesendCheckBox">
                    <label class="form-check-label" for="flexCheckDefault">
                        Köck Andreas
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="MarkusAnwesendCheckBox">
                    <label class="form-check-label" for="flexCheckDefault">
                        
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="KoeckMarkusAnwesendCheckBox">
                    <label class="form-check-label" for="flexCheckDefault">
                        Köck Markus
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="MarianAnwesendCheckBox">
                    <label class="form-check-label" for="flexCheckDefault">
                        Goller Marian
                    </label>
                </div> -->

                <div class="checkbox-wrapper-4">
                    <input class="inp-cbx" id="AndreasAnwesendCheckBox" onchange="" type="checkbox"/>
                    <label class="cbx" for="AndreasAnwesendCheckBox">
                        <span>
                            <svg width="12px" height="10px">
                                <use xlink:href="#check-4"></use>
                            </svg>
                        </span>
                        <span>Köck Andreas</span>
                    </label>
                    <svg class="inline-svg">
                        <symbol id="check-4" viewbox="0 0 12 10">
                            <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                        </symbol>
                    </svg>
                </div>

                <div class="checkbox-wrapper-4">
                    <input class="inp-cbx" id="MarkusAnwesendCheckBox" onchange="" type="checkbox"/>
                    <label class="cbx" for="MarkusAnwesendCheckBox">
                        <span>
                            <svg width="12px" height="10px">
                                <use xlink:href="#check-4"></use>
                            </svg>
                        </span>
                        <span>Unterweger Markus</span>
                    </label>
                    <svg class="inline-svg">
                        <symbol id="check-4" viewbox="0 0 12 10">
                            <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                        </symbol>
                    </svg>
                </div>

                <div class="checkbox-wrapper-4">
                    <input class="inp-cbx" id="KoeckMarkusAnwesendCheckBox" onchange="" type="checkbox"/>
                    <label class="cbx" for="KoeckMarkusAnwesendCheckBox">
                        <span>
                            <svg width="12px" height="10px">
                                <use xlink:href="#check-4"></use>
                            </svg>
                        </span>
                        <span>Köck Markus</span>
                    </label>
                    <svg class="inline-svg">
                        <symbol id="check-4" viewbox="0 0 12 10">
                            <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                        </symbol>
                    </svg>
                </div>

                <div class="checkbox-wrapper-4">
                    <input class="inp-cbx" id="MarianAnwesendCheckBox" onchange="" type="checkbox"/>
                    <label class="cbx" for="MarianAnwesendCheckBox">
                        <span>
                            <svg width="12px" height="10px">
                                <use xlink:href="#check-4"></use>
                            </svg>
                        </span>
                        <span>Goller Marian</span>
                    </label>
                    <svg class="inline-svg">
                        <symbol id="check-4" viewbox="0 0 12 10">
                            <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                        </symbol>
                    </svg>
                </div>

                
         

                
                <br>

                <strong>Einkassierte Beute:</strong><br>

                <label>Details zum Artikel ...</label>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon3" style="width: 120px;">Anzahl</span>
                    </div>
                    <input type="text" class="form-control" id="AnzahlArtikelBeuteHinzufuegenTextBox" aria-describedby="basic-addon3">
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon3" style="width: 120px;">Bezeichnung</span>
                    </div>
                    <input type="text" class="form-control" id="BezeichnungArtikelBeuteHinzufuegenTextBox" aria-describedby="basic-addon3">
                </div><br>
                
                <button type="button" onclick="BeuteHinzufuegenButtonClicked()" class="btn btn-light"><img src="https://i.imgur.com/WoPhKJy.png" class="mr-2" height="24px" alt="">  Hinzufügen</button><br>
                <br>
                <hr style="background-color: white;">
                <br>
                <strong style="font-size: x-large;">Hinzugefügte Beute:</strong><br><br>
                <div id="AuflistungBeute_EintragHinzufuegen">                    
                    <img src="https://i.imgur.com/EELyqbg.png" width="50px" alt=""><strong class="ml-2">Noch keine Beute</strong>                       
                </div>

                <br><br>
                
                <!-- OK HAKEN LINK https://i.imgur.com/X94IPqU.png -->
                <button type="button" onclick="EintragSpeichern_BeuteHinzufuegenSeite_ButtonClicked()" class="btn btn-primary"><img src="https://i.imgur.com/WoPhKJy.png" class="mr-2" height="22px" alt="">Einsatz speichern</button><br>
                
                
                
                <br><br><br><br><br><br>
                
            </div>

            <div id="Seite_Inventarsucher" style="display: none;">

                <strong style="font-size: 25pt;"><img src="https://i.imgur.com/S75sM3Y.png" class="mr-2" height="40px" alt="">Inventarsucher</strong><br><br>

                <div id="Ladezeichen_Inventarsucher" style="display: block;">
                    <div class="spinner-border text-secondary" role="status" style="text-align: center;"></div><br><br>Suche wird initialisiert ...
                </div>

                <div id="Bedienoberflaeche_Inventarsucher" style="display: none;">
                    <label>Suche nach ...</label>
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <input type="radio" onchange="Inventarsucher_SucheZuruecksetzen()" id="RadioButtonSucheNachInventarnummer" name="SucheRadioInventarsucher" aria-label="" checked><span style="margin-left: 8px;">Inventarnummer</span>
                        </div>
                        <br>
                        <div style="margin-left: 10px;" class="input-group-text">
                            <input type="radio" onchange="Inventarsucher_SucheZuruecksetzen()" id="RadioButtonSucheNachArtikel" name="SucheRadioInventarsucher" aria-label=""><span style="margin-left: 8px;">Artikel</span>
                        </div>
                    </div>

                    <br>

                    <label>Suche starten nach ...</label>
                    <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon3">Suchtext</span>
                    </div>
                    <input type="text" oninput="" class="form-control" id="Suchtext_Inventarsucher_TextBox" aria-describedby="basic-addon3">
                    </div>
                    <button onclick="Suchtext_Inventarsucher_TextChanged()" type="submit" class="btn btn-primary"><img src="https://i.imgur.com/S75sM3Y.png" class="mr-2" height="22px" alt="">Suche starten</button> <button id="QRSCAN_Button_Suche" class="btn btn-light" onclick="ReadQRCode('Suchtext_Inventarsucher_TextBox', true)"><img src="https://i.imgur.com/TONSd5l.png" class="mr-2" height="22px" alt="">InvNr-Scan</button>
                    <br>
                    <br>
                    <label><strong style="font-size: x-large;" id="Suchergebnisse_Ueberschrift_Inventarsucher">Suchergebnisse: (0)</strong></label>
                    <div id="Suchergebnisse_Inventarsucher">
                        Bitte Suchtext eingeben ...
                    </div>
                </div>

            </div>

            <div id="Seite_Zeiterfassung" style="display: none">
                <strong style="font-size: 25pt;"><img src="https://i.imgur.com/j2CymSX.png" height="40px" alt=""> Zeiterfassung</strong><br><br>
                <button onclick="ZeiterfassungSeiteButtonClicked()" type="button" class="btn btn-light"><img src="https://i.imgur.com/EwOJCjs.png" class="mr-2" height="24px" alt="">Aktualisieren</button><br><br>

                

                <div id="Ladezeichen_Zeiterfassung" style="display: block;">
                    <div class="spinner-border text-secondary" role="status" style="text-align: center;"></div><br><br>Zeiterfassung wird initialisiert ...
                </div>

                <div id="Bedienoberflaeche_Zeiterfassung" style="display: none;">
                    <strong style="font-size: 20pt;">Übersicht Mitarbeiter</strong><br><br>
                    <table class="table table-secondary table-bordered table-sm" style="font-size: smaller;">
                        <thead class="thead-dark" style="font-size: larger;">
                            <tr>
                            <th scope="col">Mitarbeiter Name</th>
                            <th scope="col">Jetzt Anwesend</th>
                            <th scope="col">Gesamte Arbeitszeit</th>
                            <th scope="col">Online Buchung</th>
                            </tr>
                        </thead>
                        <tbody id="Tabelle_Zeiterfassung_Uebersicht">
                            
                        </tbody>
                    </table>   
                    <br>
                    <strong style="font-size: 20pt;">Buchungen Liste gesamt</strong><br><br>
                    <table class="table table-secondary table-sm" style="font-size: smaller;">
                        <thead class="thead-dark" style="font-size: larger;" >
                            <tr>
                                <th scope="col">Mitarbeiter</th>
                                <th scope="col">Datum</th>
                                <th scope="col">Von-Bis</th>
                                <th scope="col">Dauer</th>
                                <th id="LoeschenSpalteTabelleZeiterfassung" scope="col">Löschen</th>
                            </tr>
                        </thead>
                        <tbody id="Tabelle_Zeiterfassung">
                            
                        </tbody>
                    </table> 
                    <br><br><br><br><br>    
                </div>
            </div>

            <div id="Seite_ArtikelBearbeiten" style="display: none;">
                <strong style="font-size: 25pt;" id="ArtikelBearbeitenUeberschrift">Artikel bearbeiten</strong><br>
                <div>Datenbank Pfad:<br><span id="ArtikelPfadInfo_ArtikelBearbeiten">Wird geladen ...</span></div><br>
                
                <div style="font-size: 15pt;">
                    <div>
                        <hr style="background-color: white;">
                        <strong style="font-size: 22pt;">Artikelname:</strong><br>
                        <strong>Aktueller Name:<br></strong> <span id="AktuellerArtikelName_BearbeitenSeite">Wird geladen ...</span><br><br>
                        <strong>Neuer Name:</strong><input id="NeuerArtikelName_BearbeitenSeite" type="text" class="form-control" placeholder="Neuer Name" aria-label="Neuer Wert" aria-describedby="basic-addon1"><br>
                        <button type="button" onclick="ArtikelBearbeiten_NameUeberschreibung_ButtonClicked()" class="btn btn-primary">Überschreiben</button><br>

                        <hr style="background-color: white;">
                        <strong style="font-size: 22pt;">Inventarnummer:</strong><br>
                        <strong>Aktuelle Inventarnummer:<br></strong> <span id="AktuelleInventarnummer_BearbeitenSeite">Wird geladen ...</span><br><br>
                        <strong>Neue Inventarnummer:</strong><input id="NeueInventarnummer_BearbeitenSeite" type="number" class="form-control" placeholder="Neue Inventarnummer" aria-label="Neuer Wert" aria-describedby="basic-addon1"><br>
                        <button type="button" onclick="ArtikelBearbeiten_InventarnummerUeberschreibung_ButtonClicked()" class="btn btn-primary">Überschreiben</button> <button class="btn btn-light" onclick="ReadQRCode('NeueInventarnummer_BearbeitenSeite', false)"><img src="https://i.imgur.com/TONSd5l.png" class="mr-2" height="22px" alt="">InvNr-Scan</button><br>

                        <hr style="background-color: white;">
                        <strong style="font-size: 22pt;">Beschreibung:</strong><br>
                        <strong>Aktuelle Beschreibung:<br></strong> <span id="AktuelleBeschreibung_BearbeitenSeite">Wird geladen ...</span><br><br>
                        <strong>Neue Beschreibung:</strong><input id="NeueBeschreibung_BearbeitenSeite" type="text" class="form-control" placeholder="Neue Beschreibung" aria-label="Neuer Wert" aria-describedby="basic-addon1"><br>
                        <button type="button" onclick="ArtikelBearbeiten_BeschreibungUeberschreibung_ButtonClicked()" class="btn btn-primary">Überschreiben</button><br>

                        <hr style="background-color: white;">
                        <strong style="font-size: 22pt;">Zustand:</strong><br>
                        <strong>Aktueller Zustand:<br></strong> <span id="AktuellerZustand_BearbeitenSeite">Wird geladen ...</span><br><br>
                        <strong>Neuer Zustand:</strong>
                        <select class="custom-select custom-select-lg mb-3" id="NeuerZustand_BearbeitenSeite">
                            <option value="Unbekannt">Unbekannt</option>
                            <option value="Funktioniert">Funktioniert</option>
                            <option value="FunktioniertTeilweise">FunktioniertTeilweise</option>                                    
                            <option value="Defekt">Defekt</option>
                        </select>
                        <button type="button" onclick="ArtikelBearbeiten_ZustandUeberschreibung_ButtonClicked()" class="btn btn-primary">Übernehmen</button><br>

                        <br><br><br><br><br><br>       
                    </div>                         
                </div>
            </div>


            <div id="Seite_CodeGenerator" style="display: none;">
                <strong style="font-size: larger;">Barcode-Download (A4 Seite)</strong><br><br>
                <button onclick="Download_BarcodePDF()" type="button" class="btn btn-light"><img src="https://i.imgur.com/3J4VDXQ.png" class="mr-2" height="22px" alt="">Herunterladen</button>


                <svg id="barcode" style="display: none;"></svg>

                <canvas id="CodeGeneratorCanvas"> 

                </canvas>
                <!-- <img src="https://barcode.tec-it.com/barcode.ashx?data=88887744%0A12234567&code=Code128&multiplebarcodes=true&translate-esc=on" alt=""> -->
            </div>

            <div id="Seite_Statistik" style="display: none; font-family: Russo One, sans-serif;">
                <strong style="font-size: 25pt;"><img class="mr-3" src="https://i.imgur.com/TPgxiEc.png" height="42px" alt="">HGEG Statistik</strong><br>
                 <br>
                <hr color="white">

                <div id="HGEG_Statistik_Ladezeichen" style="display: none;">
                    <br>
                    <div class="spinner-border text-secondary" role="status" style="text-align: center;"></div><br><br>Statistik wird erstellt ...
                </div>

                <div id="HGEG_Statistik_AnzeigeSeite" style="display: none;">
                    <br><strong style="font-size: x-large;">Einsätze:</strong><br>
                    <br>
                    <strong>Einsätze gesamt: </strong><strong id="GesamteAnzahlEinsaetze" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Erfolgreiche Einsätze: </strong><strong id="GesamteAnzahlEinsaetzeErfolgreich" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Fehlgeschlagene Einsätze: </strong><strong id="GesamteAnzahlEinsaetzeFehlschlag" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Erfolgsquote: </strong><strong id="Erfolgsquote" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <br>
                    <strong>Einsätze HGEG-Heinfels: </strong><strong id="Einsaetze_Heinfels" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze HGEG-Silgan: </strong><strong id="Einsaetze_Silgan" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze HGEG-Aichner: </strong><strong id="Einsaetze_ElektroAichner" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze HGEG-Spezial: </strong><strong id="Einsaetze_Spezial" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze HGEG-Liftmull: </strong><strong id="Einsaetze_Liftmull" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze HGEG-PHTL: </strong><strong id="Einsaetze_PHTL" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze HGEG-Stauder: </strong><strong id="Einsaetze_Stauder" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze HGEG-Allgemein: </strong><strong id="Einsaetze_Allgemein" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze HGEG-Agetech: </strong><strong id="Einsaetze_Agetech" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>                
                    <hr color="white">
                    <br><strong style="font-size: x-large;">Mitarbeiter:</strong><br>
                    <br>
                    <strong>Einsätze Unterweger Markus: </strong><strong id="Einsaetze_UntM" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze Köck Andreas: </strong><strong id="Einsaetze_KoeA" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze Köck Markus: </strong><strong id="Einsaetze_KoeM" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <strong>Einsätze Goller Marian: </strong><strong id="Einsaetze_GolM" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong><br>
                    <hr color="white">
                    <br><strong style="font-size: x-large;">Artikel:</strong><br>
                    <br>
                    <strong>Anzahl Artikel gesamt: </strong><strong id="AnzahlArtikelGesamt" style="font-size: x-large; color: rgb(255, 179, 3)">0000</strong><br>
                    <strong>Defekte Artikel: </strong><strong id="AnzahlDefekteArtikel" style="font-size: x-large; color: rgb(255, 179, 3)">0000</strong><br>
                    <strong>Ausschuss: </strong><strong id="AnzahlDefekteArtikelProzent" style="font-size: x-large; color: rgb(255, 179, 3)">0000</strong><br>
                    <br>
                    <strong>Artikel HGEG-Heinfels: </strong><strong id="Artikel_Heinfels" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong> <span style="color: rgb(255, 179, 3)" id="Artikel_Heinfels_Prozent"></span><br>
                    <strong>Artikel HGEG-Silgan: </strong><strong id="Artikel_Silgan" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong> <span style="color: rgb(255, 179, 3)" id="Artikel_Silgan_Prozent"></span><br>
                    <strong>Artikel HGEG-Aichner: </strong><strong id="Artikel_ElektroAichner" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong> <span style="color: rgb(255, 179, 3)" id="Artikel_ElektroAichner_Prozent"></span><br>
                    <strong>Artikel HGEG-Spezial: </strong><strong id="Artikel_Spezial" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong> <span style="color: rgb(255, 179, 3)" id="Artikel_Spezial_Prozent"></span><br>
                    <strong>Artikel HGEG-Liftmull: </strong><strong id="Artikel_Liftmull" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong> <span style="color: rgb(255, 179, 3)" id="Artikel_Liftmull_Prozent"></span><br>
                    <strong>Artikel HGEG-PHTL: </strong><strong id="Artikel_PHTL" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong> <span style="color: rgb(255, 179, 3)" id="Artikel_PHTL_Prozent"></span><br>
                    <strong>Artikel HGEG-Stauder: </strong><strong id="Artikel_Stauder" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong> <span style="color: rgb(255, 179, 3)" id="Artikel_Stauder_Prozent"></span><br>
                    <strong>Artikel HGEG-Allgemein: </strong><strong id="Artikel_Allgemein" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong> <span style="color: rgb(255, 179, 3)" id="Artikel_Allgemein_Prozent"></span><br>
                    <strong>Artikel HGEG-Agetech: </strong><strong id="Artikel_Agetech" style="font-size: x-large; color: rgb(255, 179, 3)">000</strong> <span style="color: rgb(255, 179, 3)" id="Artikel_Agetech_Prozent"></span><br>

                    <br><br><br><br>
                </div>                
            </div>

            <div id="Seite_Aufgaben" style="display: none;">

                <div id="Ladezeichen_Aufgaben" style="display: block;">
                    <div class="spinner-border text-secondary" role="status" style="text-align: center;"></div><br><br>Aufgaben werden geladen ...
                </div>

                

                <div id="Seite_Aufgaben_AnzeigenContainer" style="display: none;">
                    <strong style="font-size: 25pt;"><img src="https://i.imgur.com/B3ShKX0.png" height="40px" alt=""> HGEG - Aufgaben</strong><br><br><hr style="background-color: white;">

                    <div id="Seite_Aufgaben_Anzeigen">
                        <button type="button" onclick="AufgabeHinzufuegen()" class="btn btn-light"><img src="https://i.imgur.com/WoPhKJy.png" height="26px" alt=""> Aufgabe hinzufügen</button><br><hr style="background-color: white;"><br>
                
                        
                        <div id="AuflistungAufgaben"></div>
                    </div>

                    <div id="Seite_Aufgaben_Hinzufuegen" style="display: none;">
                        <button class="btn btn-danger" onclick="AufgabenSeiteInit()"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-2" height="22px" alt="">Abbrechen</button><br><hr style="background-color: white;"><br>
                    
                        <strong style="font-size: xx-large;">Aufgabe hinzufügen</strong>
                        <br><br>

                        <label>Um was geht es grob ?</label>
                        <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon3" style="width: 110px;">Titel</span>
                        </div>
                        <input type="text" class="form-control" id="NeueAufgabe_Titel" aria-describedby="basic-addon3">
                        </div><br>
                        
                        <label>Was ist genau zu machen?</label>
                        <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon3" style="width: 110px;">Details</span>
                        </div>
                        <input type="text" class="form-control" id="NeueAufgabe_Details" aria-describedby="basic-addon3">
                        </div><br>

                        <label>Wichtigkeit?</label>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="inputGroupSelect01" style="width: 110px;">Wichtigkeit</label>
                            </div>
                            <select class="custom-select" id="NeueAufgabe_Wichtigkeit">
                                <option value="3">Normal</option>
                                <option value="2">Wichtig</option>
                                <option value="1">Essentiell</option>                                    
                            </select>
                        </div>

                        <br><button type="button" onclick="AufgabeSpeichern()" class="btn btn-light"><img src="https://i.imgur.com/WoPhKJy.png" height="26px" alt=""> Speichern</button>
                        

                    </div>


                    <br><br><br><br>
                </div>

                
            </div>

            <div id="Seite_Zugzeit" style="display: none;">
                <strong style="font-size: 25pt;"><img src="https://i.imgur.com/H4x1kwH.png" height="40px" alt=""> Bus / Zugzeit</strong><br><br>
                <hr style="background-color: white;">
                
                <strong style="font-size: x-large;">Aktuelle Uhrzeit:</strong> <span style="font-size: x-large;" id="Zugzeit_AktuelleUhrzeit"></span>
                <br>
                <hr style="background-color: white;"><br>

                <strong style="font-size: x-large;">Ankünfte Sillian (Zug):</strong><br><br>
                <iframe framborder="0" style="border:0px; width: 100%; height: 320px;" src="https://fahrplan.oebb.at/bin/stboard.exe/dn?L=vs_scotty.vs_liveticker&evaId=8100142&boardType=arr&productsFilter=1011111111011&dirInput=&tickerID=arr&start=yes&eqstops=false&showJourneys=12&additionalTime=0"></iframe>
                <br><br>

                <strong style="font-size: x-large;">Abfahrten Sillian (Zug):</strong><br><br>
                <iframe framborder="0" style="border:0px; width: 100%; height: 320px;" src="https://fahrplan.oebb.at/bin/stboard.exe/dn?L=vs_liveticker&evaId=8100142&boardType=dep&productsFilter=1011111111011&dirInput=&tickerID=dep&start=yes&eqstops=false&showJourneys=12&additionalTime=0"></iframe>
                <br><br>                

                <strong style="font-size: x-large;">Ankünfte Sillian (Bus und Zug):</strong><br><br>
                <iframe framborder="0" style="border:0px; width: 100%; height: 320px;" src="https://fahrplan.oebb.at/bin/stboard.exe/dn?L=vs_scotty.vs_liveticker&evaId=1170728&boardType=arr&productsFilter=1011111111011&dirInput=&tickerID=arr&start=yes&eqstops=true&showJourneys=12&additionalTime=0"></iframe>
                <br><br>

                <strong style="font-size: x-large;">Abfahrten Sillian (Bus und Zug):</strong><br><br>
                <iframe framborder="0" style="border:0px; width: 100%; height: 320px;" src="https://fahrplan.oebb.at/bin/stboard.exe/dn?L=vs_liveticker&evaId=1170728&boardType=dep&productsFilter=1011111111011&dirInput=&tickerID=dep&start=yes&eqstops=true&showJourneys=12&additionalTime=0"></iframe>
                <br><br>            
                
                <strong style="font-size: x-large;">Ankünfte Lienz (Zug):</strong><br><br>
                <iframe framborder="0" style="border:0px; width: 100%; height: 320px;" src="https://fahrplan.oebb.at/bin/stboard.exe/dn?L=vs_scotty.vs_liveticker&evaId=8100141&boardType=arr&productsFilter=1011111111011&dirInput=&tickerID=arr&start=yes&eqstops=false&showJourneys=12&additionalTime=0"></iframe>
                <br><br> 

                <strong style="font-size: x-large;">Abfahrten Lienz (Zug):</strong><br><br>
                <iframe framborder="0" style="border:0px; width: 100%; height: 320px;" src="https://fahrplan.oebb.at/bin/stboard.exe/dn?L=vs_liveticker&evaId=8100141&boardType=dep&productsFilter=1011111111011&dirInput=&tickerID=dep&start=yes&eqstops=false&showJourneys=12&additionalTime=0"></iframe>
                <br><br> 
            </div>

            <div id="Seite_FahrzeugGesamt" style="display: none;">
                <strong style="font-size: 25pt;"><img src="https://i.imgur.com/0ceqY7Y.png" height="40px" alt="">&nbsp;&nbsp;HGEG - Fahrzeuge</strong><br><br>
                <hr style="background-color: white;">

                <div id="FahrzeugSeite_Uebersicht" style="display: none;">
                    <br>
                    <button onclick="FahrzeugSuchen()" style="margin-bottom: 8px;" type="button" class="btn btn-light"><img src="https://i.imgur.com/k62MroZ.png" class="mr-2" height="24px" alt="">Fahrzeug suchen</button><br>                              
                    <button type="button" onclick="ReadQRCode('FzgBarcodeScanZwischenablage', false, 'Fzg-Barcode scannen')" style="margin-bottom: 8px;" class="btn btn-light"><img src="https://i.imgur.com/TONSd5l.png" class="mr-2" height="24px" alt="">Fahrzeug scannen</button><br>
                    <button type="button" onclick="Schlosscode_Seite_ButtonClicked()" style="margin-bottom: 8px;" class="btn btn-light"><img src="https://cdn-icons-png.flaticon.com/512/4305/4305535.png" class="mr-2" height="22px" alt="">Zahlenschloss Codes</button><br>   
                    <button type="button" onclick="FzgStandortSuche_Seite_ButtonClicked()" style="margin-bottom: 8px;" class="btn btn-light"><img src="https://cdn-icons-png.freepik.com/512/6555/6555531.png" class="mr-2" height="22px" alt="">Standort-Suche</button><br>                 
                    <button type="button" onclick="FahrzeugeMaengellisteAnzeigen()" style="margin-bottom: 8px;" class="btn btn-warning"><img src="https://i.imgur.com/atRxfOG.png" class="mr-2" height="24px" alt="">Gesamtmängelliste anzeigen</button><br>                                        
                    <button type="button" onclick="FahrzeugHinzufügen()" style="margin-bottom: 8px;" class="btn btn-primary"><img src="https://i.imgur.com/WoPhKJy.png" class="mr-2" height="24px" alt="">Fahrzeug hinzufügen</button><br> 
                    <button type="button" onclick="SchwarzeFahrradlisteAnzeigen()" style="margin-bottom: 8px;" class="btn btn-dark"><img src="https://i.imgur.com/53SLzem.png" class="mr-2" height="24px" alt="">Schwarze Fahrradliste</button><br> 
                </div>

                <div id="FahrzeugSeite_Ladezeichen" style="display: none;">
                    <br>
                    <div class="spinner-border text-secondary" role="status" style="text-align: center;"></div><br><br>Lade Fahrzeugdatenbank ...
                </div>

                <div id="FahrzeugSeite_FahrzeugHinzufügen" style="display: none;">
                    <button class="btn btn-danger" onclick="FahrzeugSeiteInit()"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-2" height="22px" alt="">Vorgang abbrechen</button><br><hr style="background-color: white;"><br>
                    
                    <strong style="font-size: xx-large;">Fahrzeug hinzufügen</strong>
                    <br><br>

                    <label>Names des neuen Fahrzeuges ...</label>
                    <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon3" style="width: 110px;">Name</span>
                    </div>
                    <input type="text" class="form-control" id="NeuesFzg_Name" aria-describedby="basic-addon3">
                    </div><br>
                    
                    <label>Beschreibung des Fahrzeuges ...</label>
                    <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon3" style="width: 110px;">Details</span>
                    </div>
                    <input type="text" class="form-control" id="NeuesFzg_Beschreibung" aria-describedby="basic-addon3">
                    </div><br>

                    <label>Foto Link-URL (z.B. Imgur)</label>
                    <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon3" style="width: 110px;">Foto</span>
                    </div>
                    <input type="text" class="form-control" id="NeuesFzg_Foto" aria-describedby="basic-addon3">
                    </div><br>

                    <br><button type="button" onclick="FahrzeugSpeichern()" class="btn btn-light"><img src="https://i.imgur.com/WoPhKJy.png" height="26px" alt=""> Speichern</button>                    
                </div>

                <div id="FahrzeugSeite_FahrzeugSuchen" style="display: none;">
                    <button class="btn btn-danger" onclick="FahrzeugSeiteInit()"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-2" height="22px" alt="">Suche abbrechen</button><br><hr style="background-color: white;"><br>
                    
                    <strong style="font-size: xx-large;">Fahrzeug suchen</strong>
                    <br><br>

                    <label>Suche nach ...</label>
                    <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon3">Suche</span>
                    </div>
                    <input type="text" class="form-control" id="FzgSuche_TextBox" oninput="FahrzeugSuchenTextboxTextChanged()" aria-describedby="basic-addon3">
                    </div>
                    <br>  
                    <hr style="background-color: white;">
                    <br>

                    <div id="FzgSucheAuflistung"></div>
                    
                </div>

                <div id="FahrzeugSeite_Details" style="display: none;">
                    <button class="btn btn-danger" onclick="FahrzeugSeiteZurueckZurSuche()"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-2" height="22px" alt="">Zurück zur Suche</button><br><hr style="background-color: white;"><br>
                    
                    <strong style="font-size: xx-large;" id="FahrzeugDetails_Name">FzgName</strong>
                    <br><br>

                    <div style="display: none;">
                        <strong style="font-size: larger;">Beschreibung:</strong><br><span style="font-size: larger;" id="FahrzeugDetails_Beschreibung">FzgBeschr</span>
                    <br><br>
                    </div>                    
                    
                    <strong style="font-size: larger;">Fzg-Barcode:</strong><br><span style="font-size: larger;" id="FahrzeugDetails_Barcode">Unbekannt</span>
                    <br><br>

                    <strong style="font-size: larger;">Fzg-Nummer:</strong><br><span style="font-size: larger;" id="FahrzeugDetails_Id">Unbekannt</span>
                    <br><br>

                    <img src="https://i.imgur.com/aLU1B11.jpeg" id="FahrzeugDetails_FotoURL" style="width: 100%;" alt=""><br><br>

                    <div style="margin-bottom: 10px;"><strong style="font-size: larger;">Fahrzeug Status:</strong></div>
                    <div id="FahrzeugDetails_FzgGesperrt" style="display: none;">
                        <div class="alert alert-danger" role="alert">
                            <img src="https://i.imgur.com/Rj1vuiK.png" class="mr-2" height="22px" alt=""><span id="FahrzeugGesperrtInformationDatum">Fahrzeug gesperrt!</span>                                           
                        </div>                            
                    </div>                                        

                    <div class="alert alert-success" role="alert" id="FahrzeugDetails_FzgEinsatzfaehig" style="display: none;">
                        <img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="22px" alt=""> Fahrzeug ist einsatzbereit!
                    </div>

                    <strong style="font-size: larger;">Fahrzeug Zustand allgemein:</strong><br><span style="font-size: larger;" id="FahrzeugDetails_ZustandFzgAllgemein">Auf eigenes Risiko</span>
                    <br><br>

                    <strong style="font-size: larger;">Letzter bekannter Fzg-Standort:</strong><br><span style="font-size: larger;" id="FahrzeugDetails_AbgestelltOrt">FzgStandort</span>
                    <br><br>

                    <div id="FahrzeugDetails_FzgMaengelVorhanden" style="display: none;">                        
                        <div class="alert alert-warning" role="alert">
                            <img src="https://i.imgur.com/atRxfOG.png" class="mr-2" height="22px" alt=""> Mängel vorhanden!
                        </div>

                        <strong style="font-size: larger;">Aktuelle Mängelliste:</strong><br>
                        <div id="FahrzeugMaengelAuflistung">
                            
                        </div>
                        <br>
                        
                    </div>

                    <strong style="font-size: larger;">Behandelte Mängel:</strong><br>
                    <div id="FahrzeugBehobeneMaengelAuflistung">
                        
                    </div>
                    <br>

                    <br>
                    <div id="Fahrzeug_Aktionen_Button" style="display: block;">
                        <button onclick="FahrzeugAktionenSteuerelementeEinblenden()" type="button" class="btn btn-light"><img src="https://i.imgur.com/jRDR3wY.png" class="mr-2" height="26px" alt="">Bearbeiten</button>
                    </div>
                    
                    <div id="Fahrzeug_Aktionen_Steuerelemente" style="display: none;">
                        <hr style="background-color: white;"><strong style="font-size: larger;">Aktionen:</strong><br><br>

                        <label>Neuer Standort ...</label>
                        <!-- <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon3">Standort</span>
                            </div>
                            <input type="text" class="form-control" id="FzgAbstellenNeuerAbstellort" aria-describedby="basic-addon3">
                        </div> -->

                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                              <label class="input-group-text" for="inputGroupSelect01">Standort</label>
                            </div>
                            <select class="custom-select" id="NeuerStandortAuswahl" onchange="NeuerStandortAuswahlVeraendert(e('NeuerStandortAuswahl').value)">
                              <option selected value="default">Auswählen...</option>
                              <option value="Panzendorf 226">Panzendorf 226</option>
                              <option value="Panzendorf 226 (Hinterhof)">Panzendorf 226 (Hinterhof)</option>
                              <option value="Panzendorf 203">Panzendorf 203</option>
                              <option value="Hinterheinfels 160">Hinterheinfels 160</option>
                              <option value="Heinfels Bahnhst">Heinfels Bahnhst</option>
                              <option value="Sillian Bahnhof">Sillian Bahnhof</option>
                              <option value="Arnbach 65">Arnbach 65</option>
                              <option value="Panzendorf 20a">Panzendorf 20a</option>
                              <option value="other">Anderer Standort...</option>
                            </select>
                            <input type="text" class="form-control" id="NeuerStandortFreitextantwort" style="display: none;" placeholder="Standort eingeben">
                          </div>

                        <button class="btn btn-light" onclick="AktuellesFahrzeugStandortVeraendern(e('NeuerStandortAuswahl').value == 'other' ? e('NeuerStandortFreitextantwort').value : e('NeuerStandortAuswahl').value)"><img src="https://cdn-icons-png.freepik.com/512/6555/6555531.png" class="mr-2" height="22px" alt="">Standort aktualisieren</button><br><br>

                        <div id="ButtonFahrzeugSperren">                            
                            <button class="btn btn-danger" onclick="AktuellesFahrzeugSperrzustandVeraendern(true)"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-2" height="22px" alt="">Fahrzeug sperren</button>                            
                        </div>
                        
                        <button class="btn btn-light" id="ButtonFahrzeugEntsperren" onclick="AktuellesFahrzeugSperrzustandVeraendern(false)"><img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="22px" alt="">Fahrzeug entsperren</button>
                        <br>                  
                        <div class="checkbox-wrapper-4">
                            <input class="inp-cbx" id="IstAufSchwarzerListeCheckBox" onchange="SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/IstAufSchwarzerListe`, e('IstAufSchwarzerListeCheckBox').checked)" type="checkbox"/>
                            <label class="cbx" for="IstAufSchwarzerListeCheckBox">
                                <span>
                                    <svg width="12px" height="10px">
                                        <use xlink:href="#check-4"></use>
                                    </svg>
                                </span>
                                <span>Auf schwarze Liste setzen</span>
                            </label>
                            <svg class="inline-svg">
                                <symbol id="check-4" viewbox="0 0 12 10">
                                    <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                                </symbol>
                            </svg>
                        </div>
                        <br>
                        <label>Mangel hinzufügen ...</label>
                        <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon3">Mangel</span>
                        </div>
                        <input type="text" class="form-control" id="FzgNeuerMangelTextbox" aria-describedby="basic-addon3">
                        </div>
                        <button class="btn btn-warning" id="" onclick="AktuellsFahrzeugMangelHinzufuegen()"><img src="https://i.imgur.com/WoPhKJy.png" class="mr-2" height="22px" alt="">Mangel hinzufügen</button>    
                        <br><br>

                        <label>Wartungsbericht schreiben ...</label>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="inputGroupSelect01" style="width: 120px;">Bezüglich ...</label>
                            </div>
                            <select class="custom-select" id="BezueglichMangelWartungsbericht">
                                
                            </select>
                        </div>
                        <div class="input-group  mb-3">
                            <textarea class="form-control" aria-label="With textarea" id="FzgNeuerWartungsberichtTextbox" style="height: 300px;"></textarea>
                        </div>
                        <button class="btn btn-primary" id="" onclick="AktuellsFahrzeugWartungsberichtHinzufuegen()"><img src="https://i.imgur.com/WoPhKJy.png" class="mr-2" height="22px" alt="">Wartungsbericht hinzufügen</button><br><br>

                        <label>Fzg-Barcode bearbeiten ...</label>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon3">Neuer Fzg-Barcode</span>
                            </div>
                            <input type="text" class="form-control" id="NeuerFzgBarcode" aria-describedby="basic-addon3">
                        </div>
                        <button class="btn btn-light" onclick="ReadQRCode('NeuerFzgBarcode', false)"><img src="https://i.imgur.com/TONSd5l.png" class="mr-2" height="22px" alt="">Fzg-Barcode-Scan</button><button class="btn btn-light" style="margin-left: 7px;" onclick="AktuellsFahrzeugBarcodeAktualisieren(e('NeuerFzgBarcode').value)"><img src="https://i.imgur.com/WoPhKJy.png" class="mr-2" height="22px" alt="">Speichern</button><br><br>

                        <label>Untersuchungsbefund zu Datum ausgeben ...</label>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="inputGroupSelect01" style="width: 120px;">Für Datum ...</label>
                            </div>
                            <select class="custom-select" id="UntersuchungsbefundDatum">
                                
                            </select>
                        </div>
                        <button class="btn btn-light" id="" onclick="UntersuchungsbefundAusgeben(e('UntersuchungsbefundDatum').value)"><img src="https://cdn-icons-png.flaticon.com/512/209/209323.png" class="mr-2" height="22px" alt="">Untersuchungsbefund ausgeben</button><br><br>

                    </div>
                    
                </div>


                <div id="FahrzeugSeite_MaengellisteGesamt" style="display: none;">
                    <strong style="font-size: x-large;">HGEG-Fahrzeuge Mängelliste:</strong><br>
                    <strong id="InformationMaengellisteWelcheFzg">(Nur nicht gesperrte Fahrzeuge)</strong> <a href="#" onclick="MaengellisteGesamtAlleFzgAnzeigen = !MaengellisteGesamtAlleFzgAnzeigen; FahrzeugeMaengellisteAnzeigen();" class="badge badge-primary">Umschalten</a><br><br>

                    <div class="checkbox-wrapper-4">
                        <input class="inp-cbx" id="BehobeneMaengelAnzeigen" onchange="FahrzeugeMaengellisteAnzeigen()" checked type="checkbox"/>
                        <label class="cbx" for="BehobeneMaengelAnzeigen">
                            <span>
                                <svg width="12px" height="10px">
                                    <use xlink:href="#check-4"></use>
                                </svg>
                            </span>
                            <span>Behobene Mängel auch anzeigen</span>
                        </label>
                        <svg class="inline-svg">
                            <symbol id="check-4" viewbox="0 0 12 10">
                                <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                            </symbol>
                        </svg>
                    </div><br>

                    <div id="MaengellisteGesamt">

                    </div>
                </div>


                <div id="FahrzeugSeite_SchwarzeFahrradliste" style="display: none;">

                    <strong style="font-size: xx-large;">Schwarze Fahrradliste</strong><br>
                    <strong style="font-size: smaller;">Freigabe zum Ausschlachten / Verkaufen / Entsorgen</strong>
                    <br><br>

                    <div id="SchwarzeFahrradlisteGesamt">

                    </div>
                </div>

                


                <br><br><br><br>
            </div>

            <div id="Seite_Schlosscode" style="display: none; font-size: larger;">
                <strong style="font-size: 25pt;"><img src="https://cdn-icons-png.flaticon.com/512/4305/4305535.png" height="40px" alt=""> HGEG - Schlosscodes</strong><br><br>

                <hr style="background-color: white;"><br>
                <strong><img src="https://i.imgur.com/HE97iQg.png" style="width: 80px; margin-right: 15px;" alt="">Uralte Schlösser:</strong>
                <br><br>                
                
                <div class="Produkt" style="background-color: rgba(138, 36, 255, 0.24);">
                    <img src="https://cdn-icons-png.flaticon.com/512/4305/4305535.png" style="width: 40px; margin-right: 20px;" alt=""><strong>Violettes Schloss:</strong> <span style="font-family: 'Orbitron', sans-serif;" class="Schlosscode" id="ViolettesSchloss">Lade</span>
                </div>
                <div class="Produkt" style="background-color: rgba(35, 148, 82, 0.329);">
                    <img src="https://cdn-icons-png.flaticon.com/512/4305/4305535.png" style="width: 40px; margin-right: 20px;" alt=""><strong>Grünes Schloss:</strong> <span style="font-family: 'Orbitron', sans-serif;" class="Schlosscode" id="GruenesSchloss">Lade</span>
                </div>
                <div class="Produkt" style="background-color: rgba(0, 0, 0, 0.329);">
                    <img src="https://cdn-icons-png.flaticon.com/512/4305/4305535.png" style="width: 40px; margin-right: 20px;" alt=""><strong>Schwarzes Schloss:</strong> <span style="font-family: 'Orbitron', sans-serif;" class="Schlosscode" id="SchwarzesSchlossAlt">Lade</span>
                </div>
                        
                <br><br><hr style="background-color: white;"><br>
                <strong><img src="https://i.imgur.com/KEueygC.png" style="width: 80px; margin-right: 15px;" alt="">Neuere Schlösser:</strong>
                <br><br>
                
                <div class="Produkt" style="background-color: rgba(255, 174, 174, 0.432);">
                    <img src="https://cdn-icons-png.flaticon.com/512/4305/4305535.png" style="width: 40px; margin-right: 20px;" alt=""><strong>Rosarotes Schloss:</strong> <span style="font-family: 'Orbitron', sans-serif;" class="Schlosscode" id="RosarotesSchloss">Lade</span>
                </div>
                <div class="Produkt" style="background-color: rgb(110, 185, 255, 0.329);">
                    <img src="https://cdn-icons-png.flaticon.com/512/4305/4305535.png" style="width: 40px; margin-right: 20px;" alt=""><strong>Blaues Schloss:</strong> <span style="font-family: 'Orbitron', sans-serif;" class="Schlosscode" id="BlauesSchloss">Lade</span>
                </div>  
                <div class="Produkt" style="background-color: rgba(255, 255, 255, 0.404);">
                    <img src="https://cdn-icons-png.flaticon.com/512/4305/4305535.png" style="width: 40px; margin-right: 20px;" alt=""><strong>Weißes Schloss:</strong> <span style="font-family: 'Orbitron', sans-serif;" class="Schlosscode" id="WeissesSchloss">Lade</span>
                </div>
                <div class="Produkt" style="background-color: rgba(0, 0, 0, 0.329);">
                    <img src="https://cdn-icons-png.flaticon.com/512/4305/4305535.png" style="width: 40px; margin-right: 20px;" alt=""><strong>Schwarzes Schloss:</strong> <span style="font-family: 'Orbitron', sans-serif;" class="Schlosscode" id="SchwarzesSchlossNeu">Lade</span>
                </div>
                
                <br><br><hr style="background-color: white;"><br>
                <strong><img src="https://i.imgur.com/Uq13zBS.png" style="width: 80px; margin-right: 15px;" alt="">Einstellbare Schlösser:</strong>
                <br><br>

                <div class="Produkt" style="background-color: rgb(59, 59, 59);">
                    <img src="https://cdn-icons-png.flaticon.com/512/4305/4305535.png" style="width: 40px; margin-right: 20px;" alt=""><strong>4-Stellige:</strong> <span style="font-family: 'Orbitron', sans-serif;" class="Schlosscode" id="EinstellbareSchloesser">Lade</span>
                </div>
                <br><br><br><br><br><br>
            </div>

            <div id="FzgStandortSuche" style="display: none;">
                <strong style="font-size: 25pt;"><img src="https://cdn-icons-png.freepik.com/512/6555/6555531.png" height="40px" alt=""> Fahrzeug - Standorte</strong><br><br>

                <div class="Produkt" style="background-color: rgba(59, 121, 255, 0.301); width: 100%;">                    
                    <div class="Standort" id="Panzendorf 226">
                        
                    </div>
                </div>
                <div class="Produkt" style="background-color: rgba(59, 121, 255, 0.301); width: 100%;">
                    <div class="Standort" id="Panzendorf 226 (Hinterhof)">
                        
                    </div>
                </div>
                <div class="Produkt" style="background-color: rgba(59, 121, 255, 0.301); width: 100%;">
                    <div class="Standort" id="Panzendorf 203">
                        
                    </div>
                </div>
                <div class="Produkt" style="background-color: rgba(59, 121, 255, 0.301); width: 100%;">
                    <div class="Standort" id="Hinterheinfels 160">
                        
                    </div>
                </div>
                <div class="Produkt" style="background-color: rgba(59, 121, 255, 0.301); width: 100%;">
                    <div class="Standort" id="Heinfels Bahnhst">
                        
                    </div>
                </div>
                <div class="Produkt" style="background-color: rgba(59, 121, 255, 0.301); width: 100%;">
                    <div class="Standort" id="Sillian Bahnhof">
                        
                    </div>
                </div>
                <div class="Produkt" style="background-color: rgba(59, 121, 255, 0.301); width: 100%;">
                    <div class="Standort" id="Arnbach 65">
                        
                    </div>
                </div>
                <div class="Produkt" style="background-color: rgba(59, 121, 255, 0.301); width: 100%;">
                    <div class="Standort" id="Panzendorf 20a">
                        
                    </div>
                </div>       
                <div class="Produkt" style="background-color: rgba(59, 121, 255, 0.301); width: 100%;">
                    <div class="Standort" id="Anderer Standort">
                        
                    </div>
                </div>                   
            </div>
        </div>
    </div>


    <br><br><br><br>
    <footer style="height: 55px; width: 100%; position: fixed; bottom: 0px; background-color: rgb(39, 40, 44); text-align: center; font-size: smaller;">
        <div style="width: 100%; height: 1px; background-color: rgb(160, 160, 160);"></div>
        <div style="padding-top: 7px;">
            (c) 2024 HGEG GmbH, Unterweger, Köck<br><a href="" onclick="Abmelden(); location.reload();">Abmelden</a>
        </div>       
    </footer>   
</body>
</html>


<!-- Fahrzeug Seiten -->
<script>
    var Fahrzeugdatenbank = []

    var FahrzeugSeite_Uebersicht = e("FahrzeugSeite_Uebersicht")
    var FahrzeugSeite_FahrzeugSuchen = e("FahrzeugSeite_FahrzeugSuchen")
    var FahrzeugSeite_FahrzeugHinzufügen = e("FahrzeugSeite_FahrzeugHinzufügen")
    var FahrzeugSeite_Ladezeichen = e("FahrzeugSeite_Ladezeichen")
    var FahrzeugSeite_Details = e("FahrzeugSeite_Details")
    var FahrzeugSeite_MaengellisteGesamt = e("FahrzeugSeite_MaengellisteGesamt")

    var NeuesFzg_Name = e("NeuesFzg_Name")
    var NeuesFzg_Beschreibung = e("NeuesFzg_Beschreibung")
    var NeuesFzg_Foto = e("NeuesFzg_Foto")
    var FzgSuche_TextBox = e("FzgSuche_TextBox")
    var FzgSucheAuflistung = e("FzgSucheAuflistung")

    var MaengellisteGesamt = e("MaengellisteGesamt")
    var MaengellisteGesamtAlleFzgAnzeigen = false
    var InformationMaengellisteWelcheFzg = e("InformationMaengellisteWelcheFzg")

    var BezueglichMangelWartungsbericht = e("BezueglichMangelWartungsbericht")

    function FahrzeugeMaengellisteAnzeigen()
    {
        (async () =>
        {                 
            Hide(FahrzeugSeite_Uebersicht)
            Hide(FahrzeugSeite_FahrzeugSuchen)        
            Hide(FahrzeugSeite_FahrzeugHinzufügen)    
            Hide(FahrzeugSeite_Details)
            Show(FahrzeugSeite_Ladezeichen)
            Hide(FahrzeugSeite_MaengellisteGesamt)
            Hide(FahrzeugSeite_SchwarzeFahrradliste)

            MaengellisteGesamt.innerHTML = ""

            Fahrzeugdatenbank = Object.entries(await GetVariable("Fahrzeuge"))

            if(MaengellisteGesamtAlleFzgAnzeigen)
            {
                InformationMaengellisteWelcheFzg.innerHTML = "(Alle HGEG-Fahrzeuge)"
            }
            else
            {
                InformationMaengellisteWelcheFzg.innerHTML = "(Nur nicht gesperrte Fahrzeuge)"
            }

            for (var [FahrzeugId, Fahrzeug] of Fahrzeugdatenbank)
            {
                if(Fahrzeug.Maengelliste != null && (!Fahrzeug.Gesperrt || MaengellisteGesamtAlleFzgAnzeigen))
                {
                    var GesamteAnzahlMaengel = 0
                    var MangelAuflistung = ""

                    for (var [MangelId, Mangel] of Object.entries(Fahrzeug.Maengelliste))
                    {
                        if(!Mangel.Behoben)
                        {
                            GesamteAnzahlMaengel++

                            var Schweregrad = GetSchweregradFuerMangel(Mangel.Mangel)
                            var BildURL = ""

                            if(Schweregrad == "Leichter Mangel") { BildURL = "https://i.imgur.com/fpnJaV0.png" }
                            if(Schweregrad == "Mittlerer Mangel") { BildURL = "https://i.imgur.com/MRPGKN7.png" }
                            if(Schweregrad == "Schwerer Mangel") { BildURL = "https://i.imgur.com/Y7xUcvf.png" }                            
                            
                            MangelAuflistung += `<img src="${BildURL}" class="mr-2" height="24px" alt="">${Mangel.Mangel}<br>`
                        }
                    }

                    if(e("BehobeneMaengelAnzeigen").checked)
                    {
                        var ZwischenraumEingefuegt = false

                        if(MangelAuflistung == "") {ZwischenraumEingefuegt = true}


                        for (var [MangelId, Mangel] of Object.entries(Fahrzeug.Maengelliste))
                        {                    
                            if(Mangel.Behoben)
                            {
                                if(!ZwischenraumEingefuegt)
                                {
                                    ZwischenraumEingefuegt = true
                                    MangelAuflistung += `<div style="height: 5px"></div>`
                                }

                                GesamteAnzahlMaengel++
                                MangelAuflistung += `<img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="24px" alt="">${Mangel.Mangel}<br>`
                            }
                        }
                    }

                    var GesperrtInformation = ""

                    if(Fahrzeug.Gesperrt)
                    {                                    
                        GesperrtInformation = `<span class="badge badge-secondary" style="background-color: rgba(255, 154, 154, 0.459);"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-1" height="10px" alt="">GESPERRT</span> `
                    }
                    else
                    {
                        GesperrtInformation = `<span class="badge badge-secondary" style="background-color: rgba(118, 255, 152, 0.459);"><img src="https://i.imgur.com/X94IPqU.png" class="mr-1" height="10px" alt="">BEREIT</span> `
                    }                    
                    
                    if(GesamteAnzahlMaengel > 0)
                    {
                        MaengellisteGesamt.innerHTML += `
                        <div style="background-color: rgb(90, 50, 46); border-radius: 10px; padding: 15px;">
                            <strong style="font-size: x-large; color: white;">${Fahrzeug.Name}</strong><br>
                            ${GesperrtInformation}<a href="#" onclick="FahrzeugSuchenDetailsButtonClicked(${FahrzeugId})" class="badge badge-light">Details anzeigen</a><br>
                            <span class="badge badge-secondary" style="background-color: rgba(150, 150, 150, 0.445);"><img src="https://cdn-icons-png.freepik.com/512/6555/6555531.png" class="mr-1" height="10px" alt="">${Fahrzeug.OrtAbgestellt ? Fahrzeug.OrtAbgestellt : "Unauffindbar"}</span><br><br>
                            ${MangelAuflistung}                            
                        </div>
                        <br> `
                    }                                  
                }
            }

            
            if(MaengellisteGesamt.innerHTML == "")
            {
                MaengellisteGesamt.innerHTML = `<img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="22px" alt=""> Aktuell keine Mängel an den Fahrzeugen.`
            }


            Hide(FahrzeugSeite_Ladezeichen)
            Show(FahrzeugSeite_MaengellisteGesamt)
        })()
    }

    function FahrzeugSeiteInit()
    {
        Show(FahrzeugSeite_Uebersicht)
        Hide(FahrzeugSeite_FahrzeugSuchen)
        Hide(FahrzeugSeite_Ladezeichen)
        Hide(FahrzeugSeite_FahrzeugHinzufügen)
        Hide(FahrzeugSeite_Details)
        Hide(FahrzeugSeite_MaengellisteGesamt)
        Hide(FahrzeugSeite_SchwarzeFahrradliste)
    }

    function FahrzeugHinzufügen()
    {
        NeuesFzg_Name.value = ""
        NeuesFzg_Beschreibung.value = ""
        NeuesFzg_Foto.value = ""

        Hide(FahrzeugSeite_Uebersicht)
        Hide(FahrzeugSeite_FahrzeugSuchen)
        Hide(FahrzeugSeite_Ladezeichen)
        Show(FahrzeugSeite_FahrzeugHinzufügen)
        Hide(FahrzeugSeite_Details)
        Hide(FahrzeugSeite_MaengellisteGesamt)
        Hide(FahrzeugSeite_SchwarzeFahrradliste)
    }

    function SchwarzeFahrradlisteAnzeigen()
    {
        (async () =>
        {                 
            Hide(FahrzeugSeite_Uebersicht)
            Hide(FahrzeugSeite_FahrzeugSuchen)
            Hide(FahrzeugSeite_Ladezeichen)
            Hide(FahrzeugSeite_FahrzeugHinzufügen)
            Hide(FahrzeugSeite_Details)
            Hide(FahrzeugSeite_MaengellisteGesamt)
            Hide(FahrzeugSeite_SchwarzeFahrradliste)

            Fahrzeugdatenbank = Object.entries(await GetVariable("Fahrzeuge"))

            var SchwarzeFahrradlisteGesamt = e("SchwarzeFahrradlisteGesamt")            

            for (var [FahrzeugId, Fahrzeug] of Fahrzeugdatenbank)
            {
                var GesperrtInformation = ""

                if(Fahrzeug.Gesperrt)
                {                                    
                    GesperrtInformation = `<span class="badge badge-secondary" style="background-color: rgba(255, 154, 154, 0.459);"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-1" height="10px" alt="">GESPERRT</span> `
                }
                else
                {
                    GesperrtInformation = `<span class="badge badge-secondary" style="background-color: rgba(118, 255, 152, 0.459);"><img src="https://i.imgur.com/X94IPqU.png" class="mr-1" height="10px" alt="">BEREIT</span> `
                }    

                if(Fahrzeug.IstAufSchwarzerListe)
                {
                    SchwarzeFahrradlisteGesamt.innerHTML += `
                    <div style="background-color: rgb(5, 5, 5); color: rgb(230, 230, 230); border-radius: 10px; padding: 15px;">
                        <strong style="font-size: x-large; color: white;">${Fahrzeug.Name}</strong><br>
                        ${GesperrtInformation}<a href="#" onclick="FahrzeugSuchenDetailsButtonClicked(${FahrzeugId})" class="badge badge-light">Details anzeigen</a><br>
                        <span class="badge badge-secondary" style="background-color: rgba(150, 150, 150, 0.445);"><img src="https://cdn-icons-png.freepik.com/512/6555/6555531.png" class="mr-1" height="10px" alt="">${Fahrzeug.OrtAbgestellt ? Fahrzeug.OrtAbgestellt : "Unauffindbar"}</span><br><br>
                        <img src="${Fahrzeug.FotoURL}" class="mr-2" style="width: 100%;" alt="">                         
                    </div>
                    <br> `                            
                }
            }


            Show(FahrzeugSeite_SchwarzeFahrradliste)

        })()
    }

    function FahrzeugSeiteZurueckZurSuche()
    {        
        Hide(FahrzeugSeite_Uebersicht)
        Show(FahrzeugSeite_FahrzeugSuchen)
        Hide(FahrzeugSeite_Ladezeichen)
        Hide(FahrzeugSeite_FahrzeugHinzufügen)
        Hide(FahrzeugSeite_Details)
        Hide(FahrzeugSeite_MaengellisteGesamt)
        Hide(FahrzeugSeite_SchwarzeFahrradliste)
    }
    
    function FahrzeugSpeichern()
    {
        var FahrzeugId = new Date().getTime()
        var NeuerName = NeuesFzg_Name.value
        var NeueBeschr = NeuesFzg_Beschreibung.value
        var NeueFotoURL = NeuesFzg_Foto.value


        if(NeuerName == "" || NeueBeschr == "")
        {
            alert("Fehlerhafte Eingaben")
        }
        else
        {
            (async () =>
            {                 
                Hide(FahrzeugSeite_Uebersicht)
                Hide(FahrzeugSeite_FahrzeugSuchen)
                Show(FahrzeugSeite_Ladezeichen)
                Hide(FahrzeugSeite_FahrzeugHinzufügen)
                Hide(FahrzeugSeite_Details)
                Hide(FahrzeugSeite_MaengellisteGesamt)
                Hide(FahrzeugSeite_SchwarzeFahrradliste)
                
                await SetVariable(`Fahrzeuge/${FahrzeugId}/Name`, NeuerName)
                await SetVariable(`Fahrzeuge/${FahrzeugId}/Beschreibung`, NeueBeschr)
                await SetVariable(`Fahrzeuge/${FahrzeugId}/FotoURL`, NeueFotoURL)
                await SetVariable(`Fahrzeuge/${FahrzeugId}/Gesperrt`, false)
                await SetVariable(`Fahrzeuge/${FahrzeugId}/OrtAbgestellt`, "")
                await SetVariable(`Fahrzeuge/${FahrzeugId}/Name`, NeuerName)
                await SetVariable(`Fahrzeuge/${FahrzeugId}/LichtOK`, false)

                FahrzeugSeiteInit()
            })()

        }
    }

    

    function FahrzeugSuchen()
    {
        (async () =>
        {                 
            await FahrzeugSuchenAsync()
        })()
    }

    async function FahrzeugSuchenAsync()
    {
        Hide(FahrzeugSeite_Uebersicht)
        Hide(FahrzeugSeite_FahrzeugSuchen)
        Show(FahrzeugSeite_Ladezeichen)
        Hide(FahrzeugSeite_FahrzeugHinzufügen)
        Hide(FahrzeugSeite_Details)
        Hide(FahrzeugSeite_MaengellisteGesamt)
        Hide(FahrzeugSeite_SchwarzeFahrradliste)

        Fahrzeugdatenbank = Object.entries(await GetVariable("Fahrzeuge"))
        
        FzgSuche_TextBox.value = ""
        FzgSucheAuflistung.innerHTML = ""

        Hide(FahrzeugSeite_Uebersicht)
        Show(FahrzeugSeite_FahrzeugSuchen)
        Hide(FahrzeugSeite_Ladezeichen)
        Hide(FahrzeugSeite_FahrzeugHinzufügen)
        Hide(FahrzeugSeite_Details)
        Hide(FahrzeugSeite_MaengellisteGesamt)
        Hide(FahrzeugSeite_SchwarzeFahrradliste)
    }

    function FahrzeugSuchenMitBarcode(Barcode)
    {
        (async () =>
        {                
            var Gefunden = false

            Fahrzeug_ButtonClicked()
        
            if(Fahrzeugdatenbank == undefined || Fahrzeugdatenbank.length == 0)
            {
                await FahrzeugSuchenAsync()
            }
            
            for (var [FahrzeugId, Fahrzeug] of Fahrzeugdatenbank)
            {
                if(Fahrzeug.Barcode != undefined)
                {
                    if(Fahrzeug.Barcode.toLowerCase().includes(Barcode.toLowerCase()))
                    {                                        
                        FahrzeugSuchenDetailsButtonClicked(FahrzeugId)
                        Gefunden = true
                        break
                    }
                }                
            }

            if(!Gefunden) { alert("Leider kein Fzg gefunden") }
        })()

        
    }

    function FahrzeugSuchenTextboxTextChanged()
    {
        FzgSucheAuflistung.innerHTML = ""
        var Suchtext = FzgSuche_TextBox.value
        
        if(Suchtext != "")
        {
            for (var [FahrzeugId, Fahrzeug] of Fahrzeugdatenbank)
            {
                if(Fahrzeug.Name.toLowerCase().includes(Suchtext.toLowerCase()) || Fahrzeug.Beschreibung.toLowerCase().includes(Suchtext.toLowerCase()) || Suchtext == "*")
                {
                    FzgSucheAuflistung.innerHTML += `<div style="background-color: rgb(70, 70, 70); border-radius: 10px; padding: 15px;">
                        <strong style="font-size: x-large; color: white;"><img src="https://i.imgur.com/0ceqY7Y.png" class="mr-2" height="26px" alt="">${Fahrzeug.Name}</strong><br><br>
                        <strong>Beschreibung</strong>:<br>${Fahrzeug.Beschreibung}<br><br>
                        <button type="button" onclick="FahrzeugSuchenDetailsButtonClicked('${FahrzeugId}')" class="btn btn-light"><img src="https://i.imgur.com/jRDR3wY.png" class="mr-2" height="26px" alt="">Details anzeigen</button>
                    </div>
                    <br> `
                }
            }
        }

        if(FzgSucheAuflistung.innerHTML == "")
        {
            FzgSucheAuflistung.innerHTML = '<img src="https://i.imgur.com/EELyqbg.png" width="50px" alt=""><strong class="ml-2">Keine Suchergebnisse gefunden</strong>'
        }
    }

    var FahrzeugDetails_AktuelleFahrzeugId = ""
    var FzgMaengelliste_AktuellesFahrzeug = []
    var FzgWartungsberichte_AktuellesFahrzeug = []
    var FzgName_AktuellesFahrzeug = ""

    var FahrzeugDetails_Name = e("FahrzeugDetails_Name")
    var FahrzeugDetails_FotoURL = e("FahrzeugDetails_FotoURL")
    var FahrzeugDetails_FzgGesperrt = e("FahrzeugDetails_FzgGesperrt")
    var FahrzeugDetails_AbgestelltOrt = e("FahrzeugDetails_AbgestelltOrt")
    var FahrzeugDetails_FzgEinsatzfaehig = e("FahrzeugDetails_FzgEinsatzfaehig")
    var FahrzeugDetails_FzgMaengelVorhanden = e("FahrzeugDetails_FzgMaengelVorhanden")
    var FahrzeugDetails_Beschreibung = e("FahrzeugDetails_Beschreibung")
    var ButtonFahrzeugSperren = e("ButtonFahrzeugSperren")
    var ButtonFahrzeugEntsperren = e("ButtonFahrzeugEntsperren")
    var FahrzeugMaengelAuflistung = e("FahrzeugMaengelAuflistung")
    var FahrzeugBehobeneMaengelAuflistung = e("FahrzeugBehobeneMaengelAuflistung")
    var FzgAbstellenNeuerAbstellort = e("FzgAbstellenNeuerAbstellort")
    var Fahrzeug_Aktionen_Steuerelemente = e("Fahrzeug_Aktionen_Steuerelemente")
    var Fahrzeug_Aktionen_Button = e("Fahrzeug_Aktionen_Button")
    var FahrzeugGesperrtInformationDatum = e("FahrzeugGesperrtInformationDatum")

    function FahrzeugSuchenDetailsButtonClicked(FahrzeugId)
    {
        (async () =>
        {                
            FahrzeugDetails_AktuelleFahrzeugId = FahrzeugId

            Hide(FahrzeugSeite_Uebersicht)
            Hide(FahrzeugSeite_FahrzeugSuchen)        
            Hide(FahrzeugSeite_FahrzeugHinzufügen)
            Show(FahrzeugSeite_Ladezeichen)
            Hide(FahrzeugSeite_Details)
            Hide(FahrzeugSeite_MaengellisteGesamt)
            Hide(FahrzeugSeite_SchwarzeFahrradliste)

            Hide(FahrzeugDetails_FzgGesperrt)
            Hide(FahrzeugDetails_FzgEinsatzfaehig)
            Hide(FahrzeugDetails_FzgMaengelVorhanden)
            Hide(ButtonFahrzeugSperren)
            Hide(ButtonFahrzeugEntsperren)

            FzgNeuerMangelTextbox.value = ""
            FahrzeugMaengelAuflistung.innerHTML = ""
            FahrzeugBehobeneMaengelAuflistung.innerHTML = ""
            BezueglichMangelWartungsbericht.innerHTML = `<option value="Unbekannt">Unbekannt</option>`
            FahrzeugGesperrtInformationDatum.innerHTML = "Fahrzeug gesperrt!"
            //FzgAbstellenNeuerAbstellort.value = ""
            e("NeuerStandortAuswahl").value = "default"
            NeuerStandortAuswahlVeraendert(e('NeuerStandortAuswahl').value)
            e("NeuerStandortFreitextantwort").value = ""
            e("NeuerFzgBarcode").value = ""
            Hide(Fahrzeug_Aktionen_Steuerelemente)
            Show(Fahrzeug_Aktionen_Button)

            var FzgFotoURL = await GetVariable(`Fahrzeuge/${FahrzeugId}/FotoURL`)
            FahrzeugDetails_FotoURL.src = FzgFotoURL

            FzgName_AktuellesFahrzeug = await GetVariable(`Fahrzeuge/${FahrzeugId}/Name`)
            FzgBarcode_AktuellesFahrzeug = await GetVariable(`Fahrzeuge/${FahrzeugId}/Barcode`)
            var FzgBeschreibung = await GetVariable(`Fahrzeuge/${FahrzeugId}/Beschreibung`)            
            var FzgGesperrt = await GetVariable(`Fahrzeuge/${FahrzeugId}/Gesperrt`)
            FzgMaengelliste_AktuellesFahrzeug = await GetVariable(`Fahrzeuge/${FahrzeugId}/Maengelliste`)
            FzgWartungsberichte_AktuellesFahrzeug = await GetVariable(`Fahrzeuge/${FahrzeugId}/Wartungsberichte`)
            var FzgOrtAbgestellt = await GetVariable(`Fahrzeuge/${FahrzeugId}/OrtAbgestellt`)
            var FzgAbgestelltSeit = await GetVariable(`Fahrzeuge/${FahrzeugId}/AbgestelltSeit`)

            e("IstAufSchwarzerListeCheckBox").checked = await GetVariable(`Fahrzeuge/${FahrzeugId}/IstAufSchwarzerListe`)

            FahrzeugDetails_Name.innerHTML = `<img src="https://i.imgur.com/0ceqY7Y.png" class="mr-2" height="35px" alt=""> ${FzgName_AktuellesFahrzeug}`
            FahrzeugDetails_Beschreibung.innerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/1076/1076337.png" class="mr-2" height="20px" alt="">${FzgBeschreibung}`       
            e("FahrzeugDetails_Barcode").innerHTML = `<img src="https://i.imgur.com/h6khscR.png" class="mr-2" height="20px" alt="">${FzgBarcode_AktuellesFahrzeug == null ? "Unbekannt" : FzgBarcode_AktuellesFahrzeug}`
            e("FahrzeugDetails_Id").innerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/1076/1076337.png" class="mr-2" height="20px" alt="">${FahrzeugId}`

            if(FzgOrtAbgestellt != "" && FzgOrtAbgestellt != null && FzgOrtAbgestellt != undefined)
            {                
                FahrzeugDetails_AbgestelltOrt.innerHTML = `<img src="https://cdn-icons-png.freepik.com/512/6555/6555531.png" class="mr-2" height="20px" alt="">${FzgOrtAbgestellt}`   
            }
            else
            {
                FahrzeugDetails_AbgestelltOrt.innerHTML = `<img src="https://i.imgur.com/4pMrcxA.png" class="mr-2" height="20px" alt="">Unauffindbar`
            }
            
            if(FzgGesperrt)
            {
                Show(FahrzeugDetails_FzgGesperrt)
                Show(ButtonFahrzeugEntsperren)
                FahrzeugGesperrtInformationDatum.innerHTML = `Fzg gesperrt seit ${GetDatumString(new Date(parseInt(FzgAbgestelltSeit)))}`
            }
            else
            {
                Show(FahrzeugDetails_FzgEinsatzfaehig) 
                Show(ButtonFahrzeugSperren)               
            }


            if(FzgMaengelliste_AktuellesFahrzeug != null)
            {
                var AnzahlMaengelGesamt = 0  
                var AnzahlSchwereMaengel = 0
                var AnzahlMittlereMaengel = 0       

                UntersuchungsbefundDatum.innerHTML = "" 

                for (var [MangelId, MangelEintrag] of Object.entries(FzgMaengelliste_AktuellesFahrzeug))
                {
                    
                    var WartungsberichtButtonHTML = ""


                    if(FzgWartungsberichte_AktuellesFahrzeug != null)
                    {
                        for (var [WartungsberichtId, WartungsberichtEintrag] of Object.entries(FzgWartungsberichte_AktuellesFahrzeug))
                        {
                            var DisabledInformation = ""

                            if(screen.height > screen.width)
                            {
                                DisabledInformation = 'style="pointer-events: none; background-color: rgb(58, 58, 58); color: rgb(121, 121, 121);"'
                            }

                            if(WartungsberichtEintrag.BezueglichMangelId == MangelId)
                            {
                                WartungsberichtButtonHTML = ` <a href="#" onclick="WartungsberichteAnzeigenFuerManel(${MangelId}, '${MangelEintrag.Mangel}')" ${DisabledInformation} class="badge badge-light">Berichte ansehen</a>`
                            }
                        }
                    }
                                        
                    if(!MangelEintrag.Behoben)
                    {
                        var Schweregrad = GetSchweregradFuerMangel(MangelEintrag.Mangel)
                        var BildURL = ""

                        if(Schweregrad == "Leichter Mangel") { BildURL = "https://i.imgur.com/fpnJaV0.png" } //GELB: https://i.imgur.com/opDnVW5.png
                        if(Schweregrad == "Mittlerer Mangel") { BildURL = "https://i.imgur.com/MRPGKN7.png"; AnzahlMittlereMaengel++ }
                        if(Schweregrad == "Schwerer Mangel") { BildURL = "https://i.imgur.com/Y7xUcvf.png"; AnzahlSchwereMaengel++ }

                        FahrzeugMaengelAuflistung.innerHTML +=
                        `<div>
                            <img src="${BildURL}" class="mr-2" height="22px" alt=""><span class="mr-2">${MangelEintrag.Mangel}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(seit ${GetDatumString(new Date(parseInt(MangelId)))})</span><a href="#" onclick="if(confirm('Soll der Mangel\\n\\n${MangelEintrag.Mangel}\\n\\nwirklich entfernt werden?')) {AktuellesFahrzeugMangelEntfernen('${MangelId}')} " class="badge badge-light">Entfernen</a>${WartungsberichtButtonHTML}<br>
                        </div> `

                        AnzahlMaengelGesamt++
                    }       
                    else
                    {
                        FahrzeugBehobeneMaengelAuflistung.innerHTML +=
                        `<div>
                            <img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="22px" alt=""><span class="mr-2">${MangelEintrag.Mangel}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(vom ${GetDatumString(new Date(parseInt(MangelId)))})</span>${WartungsberichtButtonHTML}<br>
                        </div> `
                    }         

                    BezueglichMangelWartungsbericht.innerHTML += `<option value="${MangelId}">${MangelEintrag.Mangel} (vom ${GetDatumString(new Date(parseInt(MangelId)))})</option>`

                    var DatumMangelEingetragen = GetDatumString(new Date(parseInt(MangelId)))
                    console.log(DatumMangelEingetragen);

                    if(!UntersuchungsbefundDatum.innerHTML.includes(DatumMangelEingetragen))
                    {
                        UntersuchungsbefundDatum.innerHTML += `<option value="${DatumMangelEingetragen}">${DatumMangelEingetragen}</option>`
                    }
                }
                
                FahrzeugDetails_ZustandFzgAllgemein.innerHTML = `<img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="20px" alt="">Guter Zustand`

                if(AnzahlMaengelGesamt > 0)
                {
                    Show(FahrzeugDetails_FzgMaengelVorhanden)

                    if(AnzahlMaengelGesamt == 0 && AnzahlSchwereMaengel == 0)
                    {
                        FahrzeugDetails_ZustandFzgAllgemein.innerHTML = `<img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="20px" alt="">Sehr guter Zustand`
                    }
                    else
                    {
                        if(AnzahlMittlereMaengel > 0)
                        {
                            FahrzeugDetails_ZustandFzgAllgemein.innerHTML = `<img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="20px" alt="">Guter Zustand`

                            if(AnzahlMittlereMaengel > 2)
                            {
                                FahrzeugDetails_ZustandFzgAllgemein.innerHTML = `<img src="https://i.imgur.com/MRPGKN7.png" class="mr-2" height="20px" alt="">Zustand akzeptabel`                                
                            }
                        }

                        if(AnzahlSchwereMaengel > 0)
                        {
                            FahrzeugDetails_ZustandFzgAllgemein.innerHTML = `<img src="https://i.imgur.com/MRPGKN7.png" class="mr-2" height="20px" alt="">Zustand akzeptabel`  

                            if(AnzahlSchwereMaengel > 1)
                            {
                                FahrzeugDetails_ZustandFzgAllgemein.innerHTML = `<img src="https://i.imgur.com/Y7xUcvf.png" class="mr-2" height="20px" alt="">Schlechter Zustand`

                                if(AnzahlSchwereMaengel > 2)
                                {
                                    FahrzeugDetails_ZustandFzgAllgemein.innerHTML = `<img src="https://i.imgur.com/Rj1vuiK.png" class="mr-2" height="20px" alt="">Sehr schlechter Zustand`
                                }
                            }                            
                        }     
                    }                    
                }
                else
                {
                    FahrzeugDetails_ZustandFzgAllgemein.innerHTML = `<img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="20px" alt="">Sehr guter Zustand`
                }

                if(FzgGesperrt)
                {
                    FahrzeugDetails_ZustandFzgAllgemein.innerHTML = `<img src="https://i.imgur.com/Rj1vuiK.png" class="mr-2" height="20px" alt="">Sehr schlechter Zustand`
                }
            }
            else
            {
                FahrzeugDetails_ZustandFzgAllgemein.innerHTML = `<img src="https://i.imgur.com/X94IPqU.png" class="mr-2" height="20px" alt="">Sehr guter Zustand`
            }

            if(FahrzeugBehobeneMaengelAuflistung.innerHTML == "")
            {
                FahrzeugBehobeneMaengelAuflistung.innerHTML = "KEINE"
            }

            Hide(FahrzeugSeite_Ladezeichen)
            Show(FahrzeugSeite_Details)
        })()
    }    

    function NeuerStandortAuswahlVeraendert(value)
    {
        var inputField = document.getElementById("NeuerStandortFreitextantwort");
        if (value === "other")
        {
            inputField.style.display = "block";
        }
        else
        {
            inputField.style.display = "none";
            inputField.value = "";
        }
    }

    function AktuellesFahrzeugStandortVeraendern(NeuerStandort)
    {
        if(FahrzeugDetails_AktuelleFahrzeugId != "")
        {
            if(NeuerStandort != "default" && NeuerStandort != "")
            {
                (async () =>
                {                 
                    await SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/OrtAbgestellt`, NeuerStandort)     
                    FahrzeugSuchenDetailsButtonClicked(FahrzeugDetails_AktuelleFahrzeugId)
                })()
            }            
            else
            {
                alert("Fehlerhafte Eingabe!")
            }
        }
    }

    function AktuellsFahrzeugBarcodeAktualisieren(NeuerBarcode)
    {
        if(FahrzeugDetails_AktuelleFahrzeugId != "")
        {
            (async () =>
            {                 
                await SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/Barcode`, NeuerBarcode)     
                FahrzeugSuchenDetailsButtonClicked(FahrzeugDetails_AktuelleFahrzeugId)
            })()
        }
    }

    function AktuellesFahrzeugSperrzustandVeraendern(NeuerZustand)
    {
        if(FahrzeugDetails_AktuelleFahrzeugId != "")
        {
            (async () =>
            {                 
                var SchreibenErlaubt = true;

                if(NeuerZustand == true) //Wenn das Fzg gesperrt wird
                {
                    var NeuerStandort = e('NeuerStandortAuswahl').value == 'other' ? e('NeuerStandortFreitextantwort').value : e('NeuerStandortAuswahl').value

                    if(NeuerStandort == "" || NeuerStandort == "default")
                    {
                        SchreibenErlaubt = false
                    }
                    else
                    {
                        await SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/OrtAbgestellt`, NeuerStandort)
                        await SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/AbgestelltSeit`, new Date().getTime())
                    }
                }

                if(SchreibenErlaubt)
                {
                    await SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/Gesperrt`, NeuerZustand)
                    FahrzeugSuchenDetailsButtonClicked(FahrzeugDetails_AktuelleFahrzeugId)
                }
                else
                {
                    alert("Fehlerhafte Eingabe!")
                }
                
            })()
        }
    }

    function AktuellsFahrzeugMangelHinzufuegen()
    {
        var NeuerMangel = FzgNeuerMangelTextbox.value
        var MangelId = new Date().getTime()

        if(NeuerMangel == "")
        {
            alert("Fehlerhafte Eingabe")
        }
        else
        {
            (async () =>
            {                 
                await SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/Maengelliste/${MangelId}/Mangel`, NeuerMangel)
                await SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/Maengelliste/${MangelId}/Behoben`, false)
                FzgNeuerMangelTextbox.value = ""
                FahrzeugSuchenDetailsButtonClicked(FahrzeugDetails_AktuelleFahrzeugId)
            })()
        }
    }    
    
    function AktuellsFahrzeugWartungsberichtHinzufuegen()
    {
        var NeuerWartungsbericht = FzgNeuerWartungsberichtTextbox.value.replace(/\n/g, "#")
        var WartungsberichtId = new Date().getTime()

        if(NeuerWartungsbericht == "" || BezueglichMangelWartungsbericht.value == "Unbekannt") 
        {
            alert("Fehlerhafte Eingabe")
        }
        else
        {
            (async () =>
            {                 
                await SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/Wartungsberichte/${WartungsberichtId}/Wartungsbericht`, NeuerWartungsbericht)
                await SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/Wartungsberichte/${WartungsberichtId}/BezueglichMangelId`, BezueglichMangelWartungsbericht.value)

                FzgNeuerWartungsberichtTextbox.value = ""
                FahrzeugSuchenDetailsButtonClicked(FahrzeugDetails_AktuelleFahrzeugId)
            })()
        }
    }

    function AktuellesFahrzeugMangelEntfernen(MangelId)
    {
        (async () =>
        {                 
            await SetVariable(`Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/Maengelliste/${MangelId}/Behoben`, true)
            FahrzeugSuchenDetailsButtonClicked(FahrzeugDetails_AktuelleFahrzeugId)
        })()
    }

    function FahrzeugAktionenSteuerelementeEinblenden()
    {
        Show(Fahrzeug_Aktionen_Steuerelemente)
        Hide(Fahrzeug_Aktionen_Button)
    }

    var WartungsberichteAuflistung = e("WartungsberichteAuflistung")
    function WartungsberichteAnzeigenFuerManel(MangelId, MangelBeschreibung)
    {        
        if(screen.height > screen.width) { return; }

        if(FzgWartungsberichte_AktuellesFahrzeug != null)
        {
            ScrollPositionVorQRSCAN = window.scrollY;
            WartungsberichteAuflistung.innerHTML = ""
        
            for (var [WartungsberichtId, WartungsberichtEintrag] of Object.entries(FzgWartungsberichte_AktuellesFahrzeug))
            {
                if(WartungsberichtEintrag.BezueglichMangelId == MangelId)
                {
                    WartungsberichteAuflistung.innerHTML += `
                    <br>
                    <div style="background-color: white; color: rgb(40, 40, 40);">
                        <div class="ml-5 mr-5 mt-4">
                            <br>
                            <strong>                    
                                <span style="color: rgb(47, 90, 125); font-size: 22pt;">HGEG WARTUNGSBERICHT</span><br>
                                <span style="color: rgb(47, 90, 125); font-size: 18pt;">Fahrzeuguntersuchtung / Reparatur</span><br>                    
                            
                                <div style="font-size: 13pt;">
                                    <br>
                                    Wartungsbericht vom ${GetDatumString(new Date(parseInt(WartungsberichtId)))} um ${GetTimeString(new Date(parseInt(WartungsberichtId)))} &nbsp;|&nbsp; Wartungsbericht-Nr: ${WartungsberichtId}          
                                    <br><br>

                                    <table class="table table-bordered">
                                        <thead class="thead-light">
                                            <tr>
                                                <th scope="col">Fahrzeug</th>
                                                <th scope="col">Fzg-Nummer</th>
                                                <th scope="col">Fzg-Barcode</th>
                                                <th scope="col">Eingetragen seit</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>${FzgName_AktuellesFahrzeug}</td>
                                                <td>${FahrzeugDetails_AktuelleFahrzeugId}</td>
                                                <td>${FzgBarcode_AktuellesFahrzeug == null ? "Unbekannt" : FzgBarcode_AktuellesFahrzeug}</td>
                                                <td>${GetDatumString(new Date(parseInt(FahrzeugDetails_AktuelleFahrzeugId)))}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table class="table table-bordered">
                                        <tbody>
                                            <tr>
                                                <td>Mangel Identifikationsnummer:</td>
                                                <td>${MangelId}</td>
                                            </tr>
                                            <tr>
                                                <td>Mangel eingetragen am:</td>
                                                <td>${GetDatumString(new Date(parseInt(MangelId)))} um ${GetTimeString(new Date(parseInt(MangelId)))}</td>
                                            </tr>
                                            <tr>
                                                <td>Mangel Beschreibung:</td>
                                                <td>${MangelBeschreibung}</td>
                                            </tr>      
                                            <tr>
                                                <td>Mangel Schweregrad:</td>
                                                <td>${GetSchweregradFuerMangel(MangelBeschreibung)}</td>
                                            </tr>                                         
                                        </tbody>
                                    </table>
                                    <br>
                                    <span style="color: rgb(47, 90, 125); font-size: 18pt;">Anmerkungen<br></span>

                                    ${WartungsberichtEintrag.Wartungsbericht.replace(/#/g, "<br>")}<br>
                                    <small>Fahrzeuge/${FahrzeugDetails_AktuelleFahrzeugId}/Wartungsberichte/${WartungsberichtId}/Wartungsbericht</small>

                                    <br><br>
                                    <span style="color: rgb(47, 90, 125); font-size: 18pt;">Mit freundlichen Grüßen</span><br>
                                    HGEG GmbH Fahrzeugtechnik - Zentrale
                                </div>
                            </strong>
                        </div>            
                        <br>
                    </div>  `
                }
            }

            document.getElementById("Wartungsberichte_Seite").style.display = "block"
            document.getElementById("GesamteWebseite").style.display = "none"

        }
    }

    function GetSchweregradFuerMangel(MangelBeschreibung_Input)
    {
        var Schweregrad = "Leichter Mangel"
        var MagelBeschreibung = MangelBeschreibung_Input.toLowerCase()

        if(MagelBeschreibung.includes("kette")) { Schweregrad = "Mittlerer Mangel" }
        if(MagelBeschreibung.includes("sitz")) { Schweregrad = "Mittlerer Mangel" }
        if(MagelBeschreibung.includes("sattel")) { Schweregrad = "Mittlerer Mangel" }
        if(MagelBeschreibung.includes("licht")) { Schweregrad = "Mittlerer Mangel" }
        if(MagelBeschreibung.includes("schaltauge")) { Schweregrad = "Mittlerer Mangel" }
        if(MagelBeschreibung.includes("fehlt")) { Schweregrad = "Mittlerer Mangel" }
        if(MagelBeschreibung.includes("feder")) { Schweregrad = "Mittlerer Mangel" }
        if(MagelBeschreibung.includes("felge")) { Schweregrad = "Mittlerer Mangel" }

        if(MagelBeschreibung.includes("brems")) { Schweregrad = "Schwerer Mangel" }        
        if(MagelBeschreibung.includes("lager")) { Schweregrad = "Schwerer Mangel" }
        if(MagelBeschreibung.includes("achse")) { Schweregrad = "Schwerer Mangel" }
        if(MagelBeschreibung.includes("antrieb")) { Schweregrad = "Schwerer Mangel" }
        if(MagelBeschreibung.includes("schalt")) { Schweregrad = "Schwerer Mangel" }        
        if(MagelBeschreibung.includes("lenk")) { Schweregrad = "Schwerer Mangel" }
        if(MagelBeschreibung.includes("blockiert")) { Schweregrad = "Schwerer Mangel" }
        if(MagelBeschreibung.includes("potsch")) { Schweregrad = "Schwerer Mangel" }
        if(MagelBeschreibung.includes("luft")) { Schweregrad = "Schwerer Mangel" }
        if(MagelBeschreibung.includes("ständer")) { Schweregrad = "Schwerer Mangel" }        
        if(MagelBeschreibung.includes("rutsch")) { Schweregrad = "Schwerer Mangel" }
        if(MagelBeschreibung.includes("druck")) { Schweregrad = "Schwerer Mangel" }
        if(MagelBeschreibung.includes("klemmt")) { Schweregrad = "Schwerer Mangel" }        

        return Schweregrad
    }

    function UntersuchungsbefundAusgeben(DatumAlsDatumFormatiert)
    {
        console.log(DatumAlsDatumFormatiert);
        if(screen.height > screen.width || !DatumAlsDatumFormatiert || DatumAlsDatumFormatiert == "") { return; }

        ScrollPositionVorQRSCAN = window.scrollY;
        WartungsberichteAuflistung.innerHTML = ""

        var MaengelAnDiesemTagAuflistungString = ""

        for (var [MangelId, Mangel] of Object.entries(FzgMaengelliste_AktuellesFahrzeug))
        {
            if(GetDatumString(new Date(parseInt(MangelId))) == DatumAlsDatumFormatiert)
            {
                var Schweregrad = GetSchweregradFuerMangel(Mangel.Mangel)

                var MangelHintergrundfarbe = "white"

                if(Schweregrad.includes("Schwerer Mangel"))
                {
                    MangelHintergrundfarbe = "rgb(255, 193, 194);"
                }
                else if(Schweregrad.includes("Mittlerer Mangel"))
                {
                    MangelHintergrundfarbe = "rgb(255, 209, 181);"
                }

                MaengelAnDiesemTagAuflistungString += `
                <tr style="background-color: ${MangelHintergrundfarbe}">
                    <td>${Mangel.Mangel}</td>
                    <td>${Schweregrad}</td>
                </tr> `
            }
        }
        

        WartungsberichteAuflistung.innerHTML += `
        <br>
        <div style="background-color: white; color: rgb(40, 40, 40);">
            <div class="ml-5 mr-5 mt-4">
                <br>
                <strong>                    
                    <span style="color: rgb(181, 91, 66); font-size: 22pt;">HGEG UNTERSUCHUNGSBERICHT</span><br>
                    <span style="color: rgb(181, 91, 66); font-size: 18pt;">Fahrzeuguntersuchtung / Reparatur</span><br>                    
                
                    <div style="font-size: 13pt;">
                        <br>
                        Untersuchungsbericht vom ${DatumAlsDatumFormatiert}          
                        <br><br>

                        <table class="table table-bordered">
                            <thead class="thead-light">
                                <tr>
                                    <th scope="col">Fahrzeug</th>
                                    <th scope="col">Fzg-Nummer</th>
                                    <th scope="col">Fzg-Barcode</th>
                                    <th scope="col">Eingetragen seit</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>${FzgName_AktuellesFahrzeug}</td>
                                    <td>${FahrzeugDetails_AktuelleFahrzeugId}</td>
                                    <td>${FzgBarcode_AktuellesFahrzeug == null ? "Unbekannt" : FzgBarcode_AktuellesFahrzeug}</td>
                                    <td>${GetDatumString(new Date(parseInt(FahrzeugDetails_AktuelleFahrzeugId)))}</td>
                                </tr>
                            </tbody>
                        </table>
                        <br>
                        Festgestellte Mängel:         
                        <br><br>
                        <table class="table table-bordered">
                            <thead class="thead-light">
                                <tr>
                                    <th scope="col">Mangel Beschreibung</th>
                                    <th scope="col">Schweregrad</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${MaengelAnDiesemTagAuflistungString}                                     
                            </tbody>
                        </table>
                        <br>

                        <span style="color: rgb(181, 91, 66); font-size: 18pt;">Mit freundlichen Grüßen</span><br>
                        HGEG GmbH Fahrzeugtechnik - Zentrale
                    </div>
                </strong>
            </div>            
            <br>
        </div>  `

        document.getElementById("Wartungsberichte_Seite").style.display = "block"
        document.getElementById("GesamteWebseite").style.display = "none"

    }
</script>

<!-- Zugzeit -->
<script>



    var Zugzeit_AktuelleUhrzeit = e("Zugzeit_AktuelleUhrzeit")

    function ZugzeitSeiteInit()
    {
        (async () =>
        {                 



        })()   
    }


    setInterval(() =>
    {
        Zugzeit_AktuelleUhrzeit.innerHTML = GetTimeStringSeconds(new Date())
    }, 1000);

</script>

<!-- Statistik -->
<script>
    function Event_Statistik_Load()
    {        
        // FUER TESTZWECKE
        // var Statistik_Grunddaten = JSON.parse(localStorage.Statistik_Grunddaten);
        // console.log(Statistik_Grunddaten);
        // Statistik_Auswerten(Statistik_Grunddaten);        

        (async () =>
        {                     
            e("HGEG_Statistik_Ladezeichen").style.display = "block"
            e("HGEG_Statistik_AnzeigeSeite").style.display = "none"

            var G = await GetVariable("eintraege")

            // FUER TESTZWECKE
            // localStorage.setItem("Statistik_Grunddaten", JSON.stringify(G))

            Statistik_Auswerten(G);
        })()
    }

    function Statistik_Auswerten(Statistik_Grunddaten)
    {
        var AlleEinsaetze = Object.entries(Statistik_Grunddaten)

        var GesamteAnzahlEinsaetzeErfolgreich = 0
        var GesamteAnzahlEinsaetzeFehlschlag = 0

        var Einsaetze_UntM = 0
        var Einsaetze_KoeA = 0
        var Einsaetze_KoeM = 0
        var Einsaetze_GolM = 0

        var AnzahlEinsaetzeAllgemein = 0
        var AnzahlEinsaetzeSilgan = 0
        var AnzahlEinsaetzeHeinfels = 0
        var AnzahlEinsaetzeLiftmull = 0
        var AnzahlEinsaetzeElektroAichner = 0
        var AnzahlEinsaetzeAgetech = 0
        var AnzahlEinsaetzePHTL = 0
        var AnzahlEinsaetzeStauder = 0
        var AnzahlEinsaetzeSpezial = 0

        var AnzahlArtikelGesamt = 0

        var AnzahlArtikelAllgemein = 0
        var AnzahlArtikelSilgan = 0
        var AnzahlArtikelHeinfels = 0
        var AnzahlArtikelLiftmull = 0
        var AnzahlArtikelElektroAichner = 0
        var AnzahlArtikelAgetech = 0
        var AnzahlArtikelPHTL = 0
        var AnzahlArtikelStauder = 0
        var AnzahlArtikelSpezial = 0

        var AnzahlDefekteArtikel = 0

    
        for (var [EinsatzId, Einsatz] of AlleEinsaetze)
        {
            if(Einsatz.herkunft == "Allgemein") { AnzahlEinsaetzeAllgemein++; }
            else if(Einsatz.herkunft == "Silgan") { AnzahlEinsaetzeSilgan++; }
            else if(Einsatz.herkunft == "Heinfels") { AnzahlEinsaetzeHeinfels++; }
            else if(Einsatz.herkunft == "Liftmull") { AnzahlEinsaetzeLiftmull++; }
            else if(Einsatz.herkunft == "ElektroAichner") { AnzahlEinsaetzeElektroAichner++; }
            else if(Einsatz.herkunft == "Agetech") { AnzahlEinsaetzeAgetech++; }
            else if(Einsatz.herkunft == "PHTL") { AnzahlEinsaetzePHTL++; }
            else if(Einsatz.herkunft == "Stauder") { AnzahlEinsaetzeStauder++; }
            else if(Einsatz.herkunft == "Spezial") { AnzahlEinsaetzeSpezial++; }

            if(Einsatz.UntM) { Einsaetze_UntM++ }
            if(Einsatz.KoeA) { Einsaetze_KoeA++ }
            if(Einsatz.KoeM || Einsatz.Anmerkungen.includes("KoeckMarkus")) { Einsaetze_KoeM++ }
            if(Einsatz.GolM || Einsatz.Anmerkungen.includes("Marian")) { Einsaetze_GolM++ }

            if(typeof Einsatz.artikelListe === "object")
            {
                GesamteAnzahlEinsaetzeErfolgreich++              

                for(Artikel of Einsatz.artikelListe)
                {
                    if(Artikel != null)
                    {
                        AnzahlArtikelGesamt++

                        if(Einsatz.herkunft == "Allgemein") { AnzahlArtikelAllgemein++; }
                        else if(Einsatz.herkunft == "Silgan") { AnzahlArtikelSilgan++; }
                        else if(Einsatz.herkunft == "Heinfels") { AnzahlArtikelHeinfels++; }
                        else if(Einsatz.herkunft == "Liftmull") { AnzahlArtikelLiftmull++; }
                        else if(Einsatz.herkunft == "ElektroAichner") { AnzahlArtikelElektroAichner++; }
                        else if(Einsatz.herkunft == "Agetech") { AnzahlArtikelAgetech++; }
                        else if(Einsatz.herkunft == "PHTL") { AnzahlArtikelPHTL++; }
                        else if(Einsatz.herkunft == "Stauder") { AnzahlArtikelStauder++; }
                        else if(Einsatz.herkunft == "Spezial") { AnzahlArtikelSpezial++; }

                        if(Artikel.zustand == "Defekt")
                        {
                            AnzahlDefekteArtikel++
                        }
                    }                    
                }
            }
        }

        GesamteAnzahlEinsaetzeFehlschlag = AlleEinsaetze.length - GesamteAnzahlEinsaetzeErfolgreich

        e("GesamteAnzahlEinsaetze").innerHTML = AlleEinsaetze.length
        e("GesamteAnzahlEinsaetzeErfolgreich").innerHTML = GesamteAnzahlEinsaetzeErfolgreich
        e("GesamteAnzahlEinsaetzeFehlschlag").innerHTML = GesamteAnzahlEinsaetzeFehlschlag
        e("Erfolgsquote").innerHTML = `${((GesamteAnzahlEinsaetzeErfolgreich / AlleEinsaetze.length) * 100).toFixed(1)}%`

        e("Einsaetze_Heinfels").innerHTML = AnzahlEinsaetzeHeinfels
        e("Einsaetze_Silgan").innerHTML = AnzahlEinsaetzeSilgan
        e("Einsaetze_ElektroAichner").innerHTML = AnzahlEinsaetzeElektroAichner
        e("Einsaetze_Spezial").innerHTML = AnzahlEinsaetzeSpezial
        e("Einsaetze_Liftmull").innerHTML = AnzahlEinsaetzeLiftmull
        e("Einsaetze_Stauder").innerHTML = AnzahlEinsaetzeStauder
        e("Einsaetze_PHTL").innerHTML = AnzahlEinsaetzePHTL
        e("Einsaetze_Allgemein").innerHTML = AnzahlEinsaetzeAllgemein
        e("Einsaetze_Agetech").innerHTML = AnzahlEinsaetzeAgetech

        e("Einsaetze_UntM").innerHTML = Einsaetze_UntM
        e("Einsaetze_KoeA").innerHTML = Einsaetze_KoeA
        e("Einsaetze_KoeM").innerHTML = Einsaetze_KoeM
        e("Einsaetze_GolM").innerHTML = Einsaetze_GolM

        e("AnzahlArtikelGesamt").innerHTML = AnzahlArtikelGesamt

        e("Artikel_Heinfels").innerHTML = AnzahlArtikelHeinfels
        e("Artikel_Silgan").innerHTML = AnzahlArtikelSilgan
        e("Artikel_ElektroAichner").innerHTML = AnzahlArtikelElektroAichner
        e("Artikel_Spezial").innerHTML = AnzahlArtikelSpezial
        e("Artikel_Liftmull").innerHTML = AnzahlArtikelLiftmull
        e("Artikel_Stauder").innerHTML = AnzahlArtikelStauder
        e("Artikel_PHTL").innerHTML = AnzahlArtikelPHTL
        e("Artikel_Allgemein").innerHTML = AnzahlArtikelAllgemein
        e("Artikel_Agetech").innerHTML = AnzahlArtikelAgetech

        e("Artikel_Heinfels_Prozent").innerHTML = `(${((AnzahlArtikelHeinfels / AnzahlArtikelGesamt) * 100).toFixed(1)}%)`
        e("Artikel_Silgan_Prozent").innerHTML = `(${((AnzahlArtikelSilgan / AnzahlArtikelGesamt) * 100).toFixed(1)}%)`
        e("Artikel_ElektroAichner_Prozent").innerHTML = `(${((AnzahlArtikelElektroAichner / AnzahlArtikelGesamt) * 100).toFixed(1)}%)`
        e("Artikel_Spezial_Prozent").innerHTML = `(${((AnzahlArtikelSpezial / AnzahlArtikelGesamt) * 100).toFixed(1)}%)`
        e("Artikel_Liftmull_Prozent").innerHTML = `(${((AnzahlArtikelLiftmull / AnzahlArtikelGesamt) * 100).toFixed(1)}%)`
        e("Artikel_Stauder_Prozent").innerHTML = `(${((AnzahlArtikelStauder / AnzahlArtikelGesamt) * 100).toFixed(1)}%)`
        e("Artikel_PHTL_Prozent").innerHTML = `(${((AnzahlArtikelPHTL / AnzahlArtikelGesamt) * 100).toFixed(1)}%)`
        e("Artikel_Allgemein_Prozent").innerHTML = `(${((AnzahlArtikelAllgemein / AnzahlArtikelGesamt) * 100).toFixed(1)}%)`
        e("Artikel_Agetech_Prozent").innerHTML = `(${((AnzahlArtikelAgetech / AnzahlArtikelGesamt) * 100).toFixed(1)}%)`

        e("AnzahlDefekteArtikel").innerHTML = AnzahlDefekteArtikel;
        e("AnzahlDefekteArtikelProzent").innerHTML = `${((AnzahlDefekteArtikel / AnzahlArtikelGesamt) * 100).toFixed(1)}%`

        e("HGEG_Statistik_Ladezeichen").style.display = "none"
        e("HGEG_Statistik_AnzeigeSeite").style.display = "block"
    }



    function GetEinsatzId(ArtikelPfad)
    {
        return ArtikelPfad.split("/")[1]
    }
</script>

<!-- Aufgaben -->
<script>

    var Ladezeichen_Aufgaben = e("Ladezeichen_Aufgaben")
    var Seite_Aufgaben_AnzeigenContainer = e("Seite_Aufgaben_AnzeigenContainer")
    var Seite_Aufgaben_Anzeigen = e("Seite_Aufgaben_Anzeigen")
    var Seite_Aufgaben_Hinzufuegen = e("Seite_Aufgaben_Hinzufuegen")
    var AuflistungAufgaben = e("AuflistungAufgaben")

    function AufgabenSeiteInit()
    {
        (async () =>
        {             
            AuflistungAufgaben.innerHTML = ""

            Ladezeichen_Aufgaben.style.display = "block"
            
            Seite_Aufgaben_AnzeigenContainer.style.display = "none"
            Seite_Aufgaben_Anzeigen.style.display = "none"
            Seite_Aufgaben_Hinzufuegen.style.display = "none"

            var AlleAufgabenObjekt = await GetVariable("Aufgaben")
            var AlleAufgaben = Object.entries(AlleAufgabenObjekt)

            AlleAufgaben.sort((a, b) => a[1].Wichtigkeit - b[1].Wichtigkeit);

            for (var [AufgabeId, Aufgabe] of AlleAufgaben)
            {
                if(Aufgabe.ErledigtAm == "" && (Aufgabe.GeloeschtAm == null || Aufgabe.GeloeschtAm == "") )
                {
                    var Farbe = "rgb(70, 70, 70)"
                    var WichtigkeitString = "AUFGABE"

                    if(Aufgabe.Wichtigkeit == 1) // SEHR WICHTIG
                    {
                        Farbe = "rgb(136, 63, 63)"
                        WichtigkeitString = "ESSENTIELLE AUFGABE"
                    }
                    else if(Aufgabe.Wichtigkeit == 2) //WICHTIG
                    {
                        Farbe = "rgb(134, 84, 51)"
                        WichtigkeitString = "WICHTIGE AUFGABE"
                    }

                    AuflistungAufgaben.innerHTML += `
                    <div style="background-color: ${Farbe}; border-radius: 10px; padding: 15px;">
                        <strong style="font-size: x-large; color: white;" class="mb-4"><img src="https://i.imgur.com/3UD0Fsc.png" class="mr-2" height="50px" alt="">${WichtigkeitString}<br><span style="font-size: smaller;">${Aufgabe.Titel}</span></strong><br>
                        
                        <span>${Aufgabe.Details}</span><br><br>

                        <strong>Hinzugefügt am: </strong>${GetDatumString(new Date(parseInt(AufgabeId)))} um ${GetTimeString(new Date(parseInt(AufgabeId)))}<br>
                        <span>Bereits ${(((new Date().getTime() - parseInt(AufgabeId)) / 1000) /  86400).toFixed(1)} Tage aufgeschoben.</span>
                        <br><br>
                        
                        <button type="button" onclick="AufgabeAlsErledigtMarkieren('${AufgabeId}')" class="btn btn-light"><img src="https://i.imgur.com/u9e8ShY.png" height="26px" alt=""> Erledigt</button>
                        <button type="button" style="margin-left: 7px;" onclick="AufgabeLoeschen('${AufgabeId}')" class="btn btn-light"><img src="https://i.imgur.com/Rj1vuiK.png" height="20px" alt="">&nbsp;&nbsp;Aufgabe löschen</button>
                    </div><br> `   
                }                
            }

            if(AuflistungAufgaben.innerHTML == "")
            {
                AuflistungAufgaben.innerHTML = `<img src="https://i.imgur.com/u9e8ShY.png" height="60px" alt=""><br><br><strong style="font-size: x-large;">Aktuell keine Aufgaben</strong>`
            }

            AufgabenSeiteInitAbgeschlossen();
        })()
    }

    function AufgabenSeiteInitAbgeschlossen()
    {
        Ladezeichen_Aufgaben.style.display = "none"
                
        Seite_Aufgaben_AnzeigenContainer.style.display = "block"
        Seite_Aufgaben_Anzeigen.style.display = "block"
        Seite_Aufgaben_Hinzufuegen.style.display = "none"
    }

    function AufgabeHinzufuegen()
    {
        e("NeueAufgabe_Titel").value = ""
        e("NeueAufgabe_Details").value = ""
        e("NeueAufgabe_Wichtigkeit").value = "3"

        Ladezeichen_Aufgaben.style.display = "none"
            
        Seite_Aufgaben_AnzeigenContainer.style.display = "block"
        Seite_Aufgaben_Anzeigen.style.display = "none"
        Seite_Aufgaben_Hinzufuegen.style.display = "block"        
    }


    function AufgabeSpeichern()
    {
        (async () =>
        {           
            var Titel = e("NeueAufgabe_Titel").value
            var Details = e("NeueAufgabe_Details").value
            var Wichtigkeit = e("NeueAufgabe_Wichtigkeit").value
            var id = new Date().getTime()

            if(Titel == "" || Details == "")
            {
                alert("Fehlerhafte Eingaben")
            }
            else
            {  
                await SetVariable(`Aufgaben/${id}/Titel`, Titel)
                await SetVariable(`Aufgaben/${id}/Details`, Details)
                await SetVariable(`Aufgaben/${id}/Wichtigkeit`, Wichtigkeit)
                await SetVariable(`Aufgaben/${id}/ErledigtAm`, "")

                AufgabenSeiteInit()
            }
        })()
    }

    function AufgabeAlsErledigtMarkieren(id)
    {
        (async () =>
        {                 
            await SetVariable(`Aufgaben/${id}/ErledigtAm`, new Date().getTime())

            AufgabenSeiteInit()
        })()
    }

    function AufgabeLoeschen(id)
    {
        (async () =>
        {                 
            await SetVariable(`Aufgaben/${id}/GeloeschtAm`, new Date().getTime())

            AufgabenSeiteInit()
        })()
    }    
</script>

<!-- Hochladen lokales WinForm Betriebstagebuch -->
<!-- <script>
    var LokalesBetriebstagebuch = ""

    // Event-Listener für Änderungen im Dateiauswahldialog
    document.getElementById('fileInput').addEventListener('change', function(event) {
    // Dateiinformationen abrufen
    const file = event.target.files[0];

    if (file) {
    // FileReader erstellen
    const reader = new FileReader();

    // Event-Listener für das Laden der Datei
    reader.onload = function(e) {
        // Textinhalt aus der Datei abrufen
        const fileContent = e.target.result;

        // Textinhalt mit alert ausgeben
        LokalesBetriebstagebuch = fileContent;


        const eintraege = LokalesBetriebstagebuch.split("♥");

        console.log(eintraege.length);

        (async () =>
        {                 
            alert("Bist du dir sicher dass du das Betriebstagebuch erneut hochladen willst?")
            for (let i = 0; i < eintraege.length; i++)
            {

                var EindeutigeKennung = new Date().getTime();

                var Eintrag = eintraege[i];

                alert(`Eintrag: '${Eintrag}'`)

                console.log(`---------------   ${i} von ${eintraege.length}  ----------  ${Eintrag}`);

                var Vorinformationen = Eintrag.split("♀")[0];

                var Anmerkungen = Vorinformationen.split("|")[0];
                await SetVariable(`eintraege/${EindeutigeKennung}/Anmerkungen`, Anmerkungen)

                var GolM = JSON.parse(Vorinformationen.split("|")[1].toLowerCase())
                await SetVariable(`eintraege/${EindeutigeKennung}/GolM`, GolM)

                var KoeA = JSON.parse(Vorinformationen.split("|")[2].toLowerCase())
                await SetVariable(`eintraege/${EindeutigeKennung}/KoeA`, KoeA)

                var KoeM = JSON.parse(Vorinformationen.split("|")[3].toLowerCase())
                await SetVariable(`eintraege/${EindeutigeKennung}/KoeM`, KoeM)

                var UntM = JSON.parse(Vorinformationen.split("|")[4].toLowerCase())
                await SetVariable(`eintraege/${EindeutigeKennung}/UntM`, UntM)

                var datum = Vorinformationen.split("|")[5]
                await SetVariable(`eintraege/${EindeutigeKennung}/datum`, datum)

                var herkunft = Vorinformationen.split("|")[6]
                await SetVariable(`eintraege/${EindeutigeKennung}/herkunft`, herkunft)

                var artikelliste = Eintrag.split("♀")[1];

                if(artikelliste != "")
                {
                    var ArtikelStrings = artikelliste.split("♫");
                    for (let i = 0; i < ArtikelStrings.length; i++)
                    {
                        var beschreibung = ArtikelStrings[i].split("↕")[0];
                        await SetVariable(`eintraege/${EindeutigeKennung}/artikelListe/${i + 1}/beschreibung`, beschreibung)

                        var inventarnummer = ArtikelStrings[i].split("↕")[1];
                        await SetVariable(`eintraege/${EindeutigeKennung}/artikelListe/${i + 1}/inventarnummer`, inventarnummer)

                        var name = ArtikelStrings[i].split("↕")[2];
                        await SetVariable(`eintraege/${EindeutigeKennung}/artikelListe/${i + 1}/name`, name)

                        var zustand = ArtikelStrings[i].split("↕")[3];
                        await SetVariable(`eintraege/${EindeutigeKennung}/artikelListe/${i + 1}/zustand`, zustand)
                    }

                }

            }
        })()
    };

    // Die Datei als Text lesen
    reader.readAsText(file);
  }
});
</script> -->

<!-- Artikel Bearbeiten -->
<script>
    var ArtikelPfad_ArtikelBearbeiten_Variable = "";
    var ArtikelBearbeiten_UeberschreibenButtons_Enabled = false;

    var ArtikelBearbeitenUeberschrift = document.getElementById("ArtikelBearbeitenUeberschrift");

    var ArtikelPfadInfo_ArtikelBearbeiten = document.getElementById("ArtikelPfadInfo_ArtikelBearbeiten");

    var AktuellerArtikelName_BearbeitenSeite = document.getElementById("AktuellerArtikelName_BearbeitenSeite");
    var NeuerArtikelName_BearbeitenSeite = document.getElementById("NeuerArtikelName_BearbeitenSeite");

    var AktuelleInventarnummer_BearbeitenSeite = document.getElementById("AktuelleInventarnummer_BearbeitenSeite");
    var NeueInventarnummer_BearbeitenSeite = document.getElementById("NeueInventarnummer_BearbeitenSeite");

    var AktuelleBeschreibung_BearbeitenSeite = document.getElementById("AktuelleBeschreibung_BearbeitenSeite");
    var NeueBeschreibung_BearbeitenSeite = document.getElementById("NeueBeschreibung_BearbeitenSeite");

    var AktuellerZustand_BearbeitenSeite = document.getElementById("AktuellerZustand_BearbeitenSeite");
    var NeuerZustand_BearbeitenSeite = document.getElementById("NeuerZustand_BearbeitenSeite");

    function Event_ArtikelBearbeiten_Load(ArtikelPfad)
    {
        ArtikelPfad_ArtikelBearbeiten_Variable = ArtikelPfad;

        ArtikelBearbeitenSeiteAktualisieren();
    }

    function ArtikelBearbeitenSeiteAktualisieren()
    {
        if(ArtikelPfad_ArtikelBearbeiten_Variable != "")
        {
            (async () =>
            {           
                ArtikelBearbeiten_UeberschreibenButtons_Enabled = false;

                ArtikelPfadInfo_ArtikelBearbeiten.innerHTML = ArtikelPfad_ArtikelBearbeiten_Variable;

                AktuellerArtikelName_BearbeitenSeite.innerHTML = "Wird geladen ...";
                ArtikelBearbeitenUeberschrift.innerHTML = `Artikel bearbeiten`
                AktuelleInventarnummer_BearbeitenSeite.innerHTML = "Wird geladen ...";
                AktuelleBeschreibung_BearbeitenSeite.innerHTML = "Wird geladen ..."; NeueBeschreibung_BearbeitenSeite.value = "";
                AktuellerZustand_BearbeitenSeite.innerHTML = "Wird geladen ...";

                if(ArtikelPfad_ArtikelBearbeiten_Variable != "")
                {
                    var name = await GetVariable(`${ArtikelPfad_ArtikelBearbeiten_Variable}/name`)
                    var inventarnummer = await GetVariable(`${ArtikelPfad_ArtikelBearbeiten_Variable}/inventarnummer`)
                    var beschreibung = await GetVariable(`${ArtikelPfad_ArtikelBearbeiten_Variable}/beschreibung`)
                    var zustand = await GetVariable(`${ArtikelPfad_ArtikelBearbeiten_Variable}/zustand`)

                    AktuellerArtikelName_BearbeitenSeite.innerHTML = name;
                    ArtikelBearbeitenUeberschrift.innerHTML = `Artikel bearbeiten:<br><br>${name}<br>`
                    AktuelleInventarnummer_BearbeitenSeite.innerHTML = inventarnummer;
                    AktuelleBeschreibung_BearbeitenSeite.innerHTML = beschreibung; NeueBeschreibung_BearbeitenSeite.value = beschreibung;
                    AktuellerZustand_BearbeitenSeite.innerHTML = zustand;

                    ArtikelBearbeiten_UeberschreibenButtons_Enabled = true;
                }            
            })()
        }        
    }

    function ArtikelBearbeiten_NameUeberschreibung_ButtonClicked()
    {
        if(ArtikelPfad_ArtikelBearbeiten_Variable != "" && ArtikelBearbeiten_UeberschreibenButtons_Enabled && NeuerArtikelName_BearbeitenSeite.value != "")
        {
            (async () =>
            {                 
                await SetVariable(`${ArtikelPfad_ArtikelBearbeiten_Variable}/name`, NeuerArtikelName_BearbeitenSeite.value);
                ArtikelBearbeitenSeiteAktualisieren();
            })()
        }
        else
        {
            alert("Fehler beim Überschreiben. Format überprüfen!");
        }
    }

    function ArtikelBearbeiten_InventarnummerUeberschreibung_ButtonClicked()
    {
        if(ArtikelPfad_ArtikelBearbeiten_Variable != "" && ArtikelBearbeiten_UeberschreibenButtons_Enabled)
        {
            (async () =>
            {                 
                await SetVariable(`${ArtikelPfad_ArtikelBearbeiten_Variable}/inventarnummer`, NeueInventarnummer_BearbeitenSeite.value);
                ArtikelBearbeitenSeiteAktualisieren();
            })()
        }
        else
        {
            alert("Fehler beim Überschreiben. Format überprüfen!");
        }
    }

    function ArtikelBearbeiten_BeschreibungUeberschreibung_ButtonClicked()
    {
        if(ArtikelPfad_ArtikelBearbeiten_Variable != "" && ArtikelBearbeiten_UeberschreibenButtons_Enabled)
        {
            (async () =>
            {                 
                await SetVariable(`${ArtikelPfad_ArtikelBearbeiten_Variable}/beschreibung`, NeueBeschreibung_BearbeitenSeite.value);
                ArtikelBearbeitenSeiteAktualisieren();
            })()
        }
        else
        {
            alert("Fehler beim Überschreiben. Format überprüfen!");
        }
    }

    function ArtikelBearbeiten_ZustandUeberschreibung_ButtonClicked()
    {
        if(ArtikelPfad_ArtikelBearbeiten_Variable != "" && ArtikelBearbeiten_UeberschreibenButtons_Enabled)
        {
            (async () =>
            {                 
                await SetVariable(`${ArtikelPfad_ArtikelBearbeiten_Variable}/zustand`, NeuerZustand_BearbeitenSeite.value);
                ArtikelBearbeitenSeiteAktualisieren();
            })()
        }
        else
        {
            alert("Fehler beim Überschreiben. Format überprüfen!");
        }
    }
</script>

<!-- Zeiterfassung -->
<script>

    function openDateTimePicker()
    {
        AktuellesPopUpDateObjekt = null
        document.getElementById("overlay").style.display = "block";
        document.getElementById("dateTimeDialog").style.display = "block";

        var d = new Date()
        document.getElementById("datetimeInput").value = `${d.getFullYear()}-${(d.getMonth() + 1).toString().padStart(2, '0')}-${d.getDate().toString().padStart(2, '0')}T${d.getHours().toString().padStart(2, '0')}:${d.getMinutes().toString().padStart(2, '0')}`
    }

    function closeDateTimePicker()
    {
        document.getElementById("overlay").style.display = "none";
        document.getElementById("dateTimeDialog").style.display = "none";
    }

    function DateTimePickerIsOpen()
    {
        return document.getElementById("dateTimeDialog").style.display == "block"
    }

    function confirmDateTime()
    {
        let input = document.getElementById("datetimeInput").value;

        if (input)
        {
            AktuellesPopUpDateObjekt = new Date(input);
            closeDateTimePicker();
        }
        else
        {
            alert("Ungültiges Datum ausgewählt");
        }        
    }

    var AktuellesPopUpDateObjekt = null

    var AlleEintrage_Zeiterfassung_unveriviziert = []
    var AlleEintrage_Zeiterfassung = []
    
    var AlleMitarbeiter = []

    function Event_Zeiterfassung_Load()
    {
        document.getElementById("Ladezeichen_Zeiterfassung").style.display = "block";
        document.getElementById("Bedienoberflaeche_Zeiterfassung").style.display = "none";

        Tabelle_Zeiterfassung.innerHTML = "";
        AlleEintrage_Zeiterfassung_unveriviziert = [];   
        AlleMitarbeiter = [];

        (async () =>
        {           
            var AlleMitarbeiterEintraege = await GetSubvariablen("Mitarbeiter");

            for(Mitarbeiter of AlleMitarbeiterEintraege)
            {
                var MitarbeiterEintrag = []

                var RFID_ID = getFileName(Mitarbeiter)
                var Name = await GetVariable(`${Mitarbeiter}`)
                
                MitarbeiterEintrag.RFID_ID = RFID_ID;
                MitarbeiterEintrag.Name = Name;
                MitarbeiterEintrag.IstAnwesend = false;
                MitarbeiterEintrag.Gesamtarbeitszeit = 0;
                MitarbeiterEintrag.AnwesendSeit = 0;

                AlleMitarbeiter.push(MitarbeiterEintrag)    
            }

            var AlleEintraege = await GetVariable("Stempeluhr");

            var Array = Object.entries(AlleEintraege)
            for (var [Eintrag, JSON_objekt] of Array)
            {
                var Kommt = JSON_objekt.Kommt
                var Geht = JSON_objekt.Geht

                var Type
                var inhalt

                if(Kommt)
                {
                    Type = "Kommt"
                    inhalt = Kommt
                }
                else if(Geht)
                {
                    Type = "Geht"
                    inhalt = Geht
                }
                        
                var Eintrag = []
                
                var UnixZeitstempel = inhalt.split("_")[0]
                var RFID_ID = inhalt.split("_")[1]
                
                Eintrag.Type = Type;
                Eintrag.UnixZeitstempel = UnixZeitstempel;
                Eintrag.RFID_ID = RFID_ID;
                Eintrag.Name = GetMitarbeiterNameByRFID_ID(RFID_ID);

                AlleEintrage_Zeiterfassung_unveriviziert.push(Eintrag)                
            }

            AlleEintrage_Zeiterfassung_Verifizieren()

            // for(Eintrag of AlleEintraege)
            // {
            //     var AlleUntereintraege = await GetSubvariablen(`${Eintrag}`);

            //     AlleUntereintraege.forEach((Untereintrag, n) =>
            //     {
            //         (async () =>
            //         {                                 
            //             var inhalt = await GetVariable(`${Untereintrag}`)
                        
            //             var Eintrag = []

            //             var Type = getFileName(Untereintrag);
            //             var UnixZeitstempel = inhalt.split("_")[0]
            //             var RFID_ID = inhalt.split("_")[1]
                        
            //             Eintrag.Type = Type;
            //             Eintrag.UnixZeitstempel = UnixZeitstempel;
            //             Eintrag.RFID_ID = RFID_ID;
            //             Eintrag.Name = GetMitarbeiterNameByRFID_ID(RFID_ID);

            //             AlleEintrage_Zeiterfassung_unveriviziert.push(Eintrag)

            //             AlleEintrage_Zeiterfassung_Verifizieren()
            //         })()                         
            //     })
            // }


            
        })()
    }

    function GetDatumString(DatumObjekt)
    {
        const tag = DatumObjekt.getDate().toString().padStart(2, '0');
        const monat = (DatumObjekt.getMonth() + 1).toString().padStart(2, '0');
        const jahr = DatumObjekt.getFullYear();


        return formatiertesDatum = `${tag}.${monat}.${jahr}`;
    }

    function GetTimeString(DatumObjekt)
    {
        const stunden = DatumObjekt.getHours().toString().padStart(2, '0');
        const minuten = DatumObjekt.getMinutes().toString().padStart(2, '0');

        return `${stunden}:${minuten}`;
    }

    function GetTimeStringSeconds(DatumObjekt)
    {
        const stunden = DatumObjekt.getHours().toString().padStart(2, '0');
        const minuten = DatumObjekt.getMinutes().toString().padStart(2, '0');
        const sekunden = DatumObjekt.getSeconds().toString().padStart(2, '0');

        return `${stunden}:${minuten}:${sekunden}`;
    }

    function GetDatumWoDieSekundenAuf0GesetztSind(datum)
    {
        return new Date(datum.getFullYear(), datum.getMonth(), datum.getDate(), datum.getHours(), datum.getMinutes(), 0)
    }

    function zeitDifferenz(datum1, datum2)
    {
        var datum1verw = GetDatumWoDieSekundenAuf0GesetztSind(datum1)
        var datum2verw = GetDatumWoDieSekundenAuf0GesetztSind(datum2)

        // Zeitdifferenz in Millisekunden berechnen
        const differenzInMillisekunden = Math.abs(datum1verw - datum2verw);

        // Zeitdifferenz in Stunden und Minuten umrechnen
        const stunden = Math.floor(differenzInMillisekunden / (1000 * 60 * 60));
        const minuten = Math.floor((differenzInMillisekunden % (1000 * 60 * 60)) / (1000 * 60));

        // Zeitdifferenz im Format "1h 23min" zurückgeben
        return `${stunden.toString().padStart(2, '0')}:${minuten.toString().padStart(2, '0')}`;
    }

    
    function ZeitInHundMin(differenzInMillisekunden)
    {

        // Zeitdifferenz in Stunden und Minuten umrechnen
        const stunden = Math.floor(differenzInMillisekunden / (1000 * 60 * 60));
        const minuten = Math.floor((differenzInMillisekunden % (1000 * 60 * 60)) / (1000 * 60));

        // Zeitdifferenz im Format "00:00" zurückgeben
        return `${stunden.toString().padStart(2, '0')}:${minuten.toString().padStart(2, '0')}`;
    }

    function OnlineBuchungNachtragen(Kommen1_Gehen0, MitarbeiterID)
    {
        (async () =>
        {                 
            openDateTimePicker();

            while (await DateTimePickerIsOpen())
            {
                await new Promise(resolve => setTimeout(resolve, 100));
            }

            if(AktuellesPopUpDateObjekt)
            {
                var Zeit = (AktuellesPopUpDateObjekt.getTime() / 1000).toFixed(0)
                await SetVariable(`Stempeluhr/Eintrag${Zeit}/${Kommen1_Gehen0 == 1 ? "Kommt" : "Geht"}`, `${Zeit}_${MitarbeiterID}`)

                ZeiterfassungSeiteButtonClicked();                
            }
        })()        
    }
    
    function OnlineBuchung(Kommen1_Gehen0, MitarbeiterID)
    {
        (async () =>
        {                 
            var Zeit = (new Date().getTime() / 1000).toFixed(0)
            await SetVariable(`Stempeluhr/Eintrag${Zeit}/${Kommen1_Gehen0 == 1 ? "Kommt" : "Geht"}`, `${Zeit}_${MitarbeiterID}`)

            ZeiterfassungSeiteButtonClicked();
        })()        
    }

    function BuchungspaarLoeschen(GesamterVariablenpfad1, GesamterVariablenpfad2)
    {
        if(window.confirm("Wirklich löschen?"))
        {
            (async () =>
            {                 
                await deleteVariable(GesamterVariablenpfad1)
                await deleteVariable(GesamterVariablenpfad2)

                ZeiterfassungSeiteButtonClicked();
            })()   
        }              
    }
    
    var Tabelle_Zeiterfassung = document.getElementById("Tabelle_Zeiterfassung")
    var Tabelle_Zeiterfassung_Uebersicht = document.getElementById("Tabelle_Zeiterfassung_Uebersicht")

    function AlleEintrage_Zeiterfassung_Verifizieren()
    {
        if(IstHandy())
        {
            Hide(e("LoeschenSpalteTabelleZeiterfassung"))
        }

        Tabelle_Zeiterfassung.innerHTML = "";
        Tabelle_Zeiterfassung_Uebersicht.innerHTML = "";

        var AnzahlMitarbeiter = AlleMitarbeiter.length
        
        var pos = 0;
        for(Mitarbeiter of AlleMitarbeiter)
        {           
            pos++

            var IstAnwesend = false;
            var ZeitVonBis = "";
            var Startzeit;
            var Dauer;
            var Gesamtarbeitszeit = 0;
            
            var UnixZeitstempelKommt = 0
            var UnixZeitstempelGeht = 0

            for(Eintrag of AlleEintrage_Zeiterfassung_unveriviziert)
            {   
                var DiesIstEinGueltigerEintrag = false;             

                if(Eintrag.Name == Mitarbeiter.Name)
                {
                    var DatumObjekt = new Date(parseInt(`${Eintrag.UnixZeitstempel}000`))
                    //DatumObjekt.setTime(DatumObjekt.getTime() + (2 * 60 * 60 * 1000));
                    var DatumString = GetDatumString(DatumObjekt)

                    if(Eintrag.Type == "Kommt" && !IstAnwesend)
                    {
                        DiesIstEinGueltigerEintrag = true
                        IstAnwesend = true
                        Mitarbeiter.IstAnwesend = true
                        ZeitVonBis += `${GetTimeString(DatumObjekt)} - `
                        Startzeit = DatumObjekt
                        Mitarbeiter.AnwesendSeit = GetDatumWoDieSekundenAuf0GesetztSind(Startzeit)
                        UnixZeitstempelKommt = Eintrag.UnixZeitstempel
                    }
                    else if(Eintrag.Type == "Geht" && IstAnwesend)
                    {
                        DiesIstEinGueltigerEintrag = true
                        IstAnwesend = false
                        Mitarbeiter.IstAnwesend = false
                        ZeitVonBis += `${GetTimeString(DatumObjekt)}`
                        Dauer = `${zeitDifferenz(Startzeit, DatumObjekt)}`
                        Gesamtarbeitszeit += Math.abs(GetDatumWoDieSekundenAuf0GesetztSind(DatumObjekt).getTime() - GetDatumWoDieSekundenAuf0GesetztSind(Startzeit).getTime())                 
                        UnixZeitstempelGeht = Eintrag.UnixZeitstempel
                    }

                    if(DiesIstEinGueltigerEintrag && Eintrag.Type == "Geht")
                    {
                        Tabelle_Zeiterfassung.innerHTML += `
                        <tr>
                            <th scope="row">${Mitarbeiter.Name}</th>
                            <td>${DatumString}</td>
                            <td>${ZeitVonBis}</td>
                            <td>${Dauer}</td>                            
                            ${IstHandy() ? "" : `<td><a href="#" onclick="BuchungspaarLoeschen('Stempeluhr/Eintrag${UnixZeitstempelKommt}', 'Stempeluhr/Eintrag${UnixZeitstempelGeht}');" class="badge badge-danger"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-1" height="10px" alt="">Löschen</a></td>`}
                        </tr> `   


                        ZeitVonBis = "";
                    }
                }
            } 

            if(pos < AnzahlMitarbeiter)
            {
                Tabelle_Zeiterfassung.innerHTML += `
                <tr style="background-color: rgb(52, 58, 64)">
                    <th scope="row"></th>
                    <td></td>
                    <td></td>
                    <td></td>
                    ${IstHandy() ? "" : "<td></td>"}
                </tr> `   
            }
            
            Mitarbeiter.Gesamtarbeitszeit = Gesamtarbeitszeit;             
        }

        for(Mitarbeiter of AlleMitarbeiter)
        {
            Tabelle_Zeiterfassung_Uebersicht.innerHTML += `
            <tr>
                <th scope="row">${Mitarbeiter.Name}<br><span style="font-size: x-small;">(ID: ${Mitarbeiter.RFID_ID})</span></th>
                <td style="color: green; ${IstHandy() ? 'text-align: center;' : ''}">${Mitarbeiter.IstAnwesend ? `<strong>JA<br></strong>Seit ${zeitDifferenz(Mitarbeiter.AnwesendSeit, GetDatumWoDieSekundenAuf0GesetztSind(new Date()))}` : `<strong style="color: rgb(196, 0, 0);">NEIN</strong>`}</td>
                <td style="${IstHandy() ? 'text-align: center;' : ''}">${ZeitInHundMin(Mitarbeiter.Gesamtarbeitszeit)}</td>
                <td>
                    
                    ${IstHandy() ? `
                    <button onclick="OnlineBuchung(1, ${Mitarbeiter.RFID_ID})" type="button" style="margin-bottom: 8px;" class="btn btn-light"><img src="https://i.imgur.com/TEKsgJO.png" class="mr-2" height="24px" alt="">Kommt</button><br>
                    <button onclick="OnlineBuchung(0, ${Mitarbeiter.RFID_ID})" type="button" class="btn btn-light"><img src="https://i.imgur.com/45FpYsM.png" class="mr-2" height="24px" alt="">Geht</button>
                    `:`
                    <button onclick="OnlineBuchung(1, ${Mitarbeiter.RFID_ID})" type="button" class="btn btn-light"><img src="https://i.imgur.com/TEKsgJO.png" class="mr-2" height="24px" alt="">Kommt</button>
                    <button onclick="OnlineBuchung(0, ${Mitarbeiter.RFID_ID})" type="button" class="btn btn-light"><img src="https://i.imgur.com/45FpYsM.png" class="mr-2" height="24px" alt="">Geht</button>
                    <button onclick="OnlineBuchungNachtragen(1, ${Mitarbeiter.RFID_ID})" type="button" class="btn btn-light"><img src="https://i.imgur.com/TEKsgJO.png" class="mr-2" height="24px" alt="">Kommt Nachtragen</button>
                    <button onclick="OnlineBuchungNachtragen(0, ${Mitarbeiter.RFID_ID})" type="button" class="btn btn-light"><img src="https://i.imgur.com/45FpYsM.png" class="mr-2" height="24px" alt="">Geht Nachtragen</button>

                    `
                    }

                </td>
            </tr> `
        }

        document.getElementById("Ladezeichen_Zeiterfassung").style.display = "none";
        document.getElementById("Bedienoberflaeche_Zeiterfassung").style.display = "block";
    }

    
</script>

<!-- Seiten Switcher -->
<script>
    // var Seite_EintragHinzufuegen = document.getElementById("Seite_EintragHinzufuegen");
    // var Seite_AuflistungEinsaetze = document.getElementById("Seite_AuflistungEinsaetze");
    // var Seite_Inventarsucher = document.getElementById("Seite_Inventarsucher");
    // var Seite_ArtikelBearbeiten = document.getElementById("Seite_ArtikelBearbeiten");
    // var Seite_Zeiterfassung = document.getElementById("Seite_Zeiterfassung");
    // var Seite_CodeGenerator = document.getElementById("Seite_CodeGenerator");
    // var Seite_Aufgaben = e("Seite_Aufgaben");
    // var Seite_Zugzeit = e("Seite_Zugzeit")
    // var Seite_FahrzeugGesamt = e("Seite_FahrzeugGesamt")

    function Event_AnmeldungAbgeschlossen()
    {
        if(extractParameter("Init") == "Fzg_Suche_Aufrufen")
        {
            ReadQRCode('FzgBarcodeScanZwischenablage', false, "Fzg-Barcode scannen")
        }

        (async () =>
        {                 
            LinkBetriebsvorschriftenHGEGSilgan = await GetVariable('DiverseDaten/BetriebsvorschrHGEGSilgan');
        })()
    }

    function GetMitarbeiterNameByRFID_ID(RFID_ID)
    {
        for(Mitarbeiter of AlleMitarbeiter)
        {
            if(Mitarbeiter.RFID_ID == RFID_ID)
            {
                return Mitarbeiter.Name
            }
        }

        return "Unbekannt"
    }

    function SeiteAufrufen(SeiteName)
    {
        if(IstAngemeldet)
        {
            ButtonsHauptmenue.style.display = 'none'; ButtonsHauptmenueAnzeigenButton.style.display = 'block'

            Seite_EintragHinzufuegen.style.display = "none";
            Seite_AuflistungEinsaetze.style.display = "none";
            Seite_Inventarsucher.style.display = "none";
            Seite_ArtikelBearbeiten.style.display = "none";
            Seite_Zeiterfassung.style.display = "none";
            Seite_CodeGenerator.style.display = "none";
            Seite_Statistik.style.display = "none";
            Seite_Aufgaben.style.display = "none";
            Seite_Zugzeit.style.display = "none";
            Seite_FahrzeugGesamt.style.display = "none";
            Seite_Schlosscode.style.display = "none"
            FzgStandortSuche.style.display = "none"

            e(SeiteName).style.display = "block"
        }
    }

    function Hauptmenue_Seite_ButtonClicked()
    {
        SeiteAufrufen("Seite_AuflistungEinsaetze")        
    }

    function EintragHinzufuegen_Seite_ButtonClicked()
    {
        SeiteAufrufen("Seite_EintragHinzufuegen")
    }

    function Inventarsucher_Seite_ButtonClicked()
    {
        if(IstAngemeldet)
        {
            GesamteBeuteAuflistungInventarSucher = [];
            
            SeiteAufrufen("Seite_Inventarsucher")

            InventarsucherInit();
        }
    }

    function ZeiterfassungSeiteButtonClicked()
    {
        if(IstAngemeldet)
        {
            SeiteAufrufen("Seite_Zeiterfassung")

            Event_Zeiterfassung_Load();
        }
    }

    function ArtikelBearbeiten_Seite_Oeffnen(ArtikelPfad)
    {
        if(IstAngemeldet && ArtikelPfad != "" && ArtikelPfad != undefined)
        {
            SeiteAufrufen("Seite_ArtikelBearbeiten")

            Event_ArtikelBearbeiten_Load(ArtikelPfad);
        }
    }

    function CodeGenerator_Seite_ButtonClicked()
    {
        if(IstAngemeldet)
        {
            SeiteAufrufen("Seite_CodeGenerator")

            Event_CodeGenerator_Load();
        }
    }

    function Statistik_ButtonClicked()
    {
        if(IstAngemeldet)
        {
            SeiteAufrufen("Seite_Statistik")

            Event_Statistik_Load();
        }
    }

    function Aufgaben_ButtonClicked()
    {
        if(IstAngemeldet)
        {
            SeiteAufrufen("Seite_Aufgaben")

            AufgabenSeiteInit();
        }
    }

    function Zugzeit_ButtonClicked()
    {
        if(IstAngemeldet)
        {
            SeiteAufrufen("Seite_Zugzeit")

            ZugzeitSeiteInit();
        }
    }

    function Fahrzeug_ButtonClicked()
    {
        if(IstAngemeldet)
        {
            SeiteAufrufen("Seite_FahrzeugGesamt")

            FahrzeugSeiteInit();
        }
    }

    function Schlosscode_Seite_ButtonClicked()
    {
        if(IstAngemeldet)
        {
            SeiteAufrufen("Seite_Schlosscode");

            (async () =>
            {                 
                var Schlosscodes = Seite_Schlosscode.querySelectorAll(".Schlosscode");

                for(Schlosscode of Schlosscodes)
                {
                    var Code = await GetVariable(`Schlosscodes/${Schlosscode.id}`)
                    Schlosscode.innerHTML = Code
                }
            })()
        }        
    }

    function FzgStandortSuche_Seite_ButtonClicked()
    {
        if(IstAngemeldet)
        {
            SeiteAufrufen("FzgStandortSuche");

            (async () =>
            {               
                await FahrzeugSuchenAsync()

                var StandortElemente = FzgStandortSuche.querySelectorAll(".Standort");

                var StandortStringAlleStandorte = ""

                for(StandortElement of StandortElemente)
                {
                    StandortStringAlleStandorte += StandortElement.id.toLowerCase()
                }


                for(StandortElement of StandortElemente)
                {
                    var NeuesInnerHTML = ""
                    var AnzahlFzgHier = 0
                    StandortElement.innerHTML = ""

                    for (var [FahrzeugId, Fahrzeug] of Fahrzeugdatenbank)
                    {
                        if(Fahrzeug.OrtAbgestellt)
                        {
                            if(Fahrzeug.OrtAbgestellt.toLowerCase() == StandortElement.id.toLowerCase() || (StandortElement.id.includes("Andere") && !StandortStringAlleStandorte.includes(Fahrzeug.OrtAbgestellt.toLowerCase())))
                            {
                                AnzahlFzgHier++
                                var GesperrtInformation

                                if(Fahrzeug.Gesperrt)
                                {                                    
                                    GesperrtInformation = `<a href="#" onclick="Fahrzeug_ButtonClicked(); FahrzeugSuchenDetailsButtonClicked(${FahrzeugId})" class="badge badge-secondary" style="background-color: rgba(255, 154, 154, 0.459);"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-1" height="10px" alt="">GESPERRT</a> `
                                }
                                else
                                {
                                    GesperrtInformation = `<a href="#" onclick="Fahrzeug_ButtonClicked(); FahrzeugSuchenDetailsButtonClicked(${FahrzeugId})" class="badge badge-secondary" style="background-color: rgba(118, 255, 152, 0.459);"><img src="https://i.imgur.com/X94IPqU.png" class="mr-1" height="10px" alt="">BEREIT</a> `
                                
                                    if(Fahrzeug.Maengelliste != null)
                                    {
                                        var GesamteAnzahlMaengel = 0

                                        for (var [MangelId, Mangel] of Object.entries(Fahrzeug.Maengelliste))
                                        {
                                            if(!Mangel.Behoben)
                                            {
                                                GesperrtInformation = `<a href="#" onclick="Fahrzeug_ButtonClicked(); FahrzeugSuchenDetailsButtonClicked(${FahrzeugId})" class="badge badge-secondary" style="background-color: rgba(255, 151, 110, 0.445);"><img src="https://i.imgur.com/atRxfOG.png" class="mr-1" height="10px" alt="">BEREIT</a> `
                                                break
                                            }
                                        }
                                    }
                                }

                                if(Fahrzeug.Barcode)
                                {
                                    GesperrtInformation += `<span class="badge badge-secondary" style="background-color: rgba(118, 155, 152, 0.259);"><img src="https://i.imgur.com/h6khscR.png" class="mr-1" height="10px" alt="">BC</span> `
                                }

                                NeuesInnerHTML += `
                                <img src="https://i.imgur.com/0ceqY7Y.png" class="mr-2" height="18px" alt=""><span style="width: 160px">${Fahrzeug.Name}</span> ${GesperrtInformation}<br> `
                            }
                        }
                        
                    }    

                    if(NeuesInnerHTML == "") 
                    {
                        NeuesInnerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/1159/1159417.png" class="mr-2" height="18px" alt=""><span>Derzeit kein Fahrzeug abgestellt</span><br>`
                    }

                    StandortElement.innerHTML = `<span style="font-size: larger;"><strong>${StandortElement.id}</strong> (${AnzahlFzgHier})</span><br>${NeuesInnerHTML}`
                }                
            })()
        }    
    }

    if(cookieExists("PasswortBetriebstagebuch"))
    {
        InitBetriebstagebuch(getCookie("PasswortBetriebstagebuch"))
    }
    else
    {
        document.getElementById("AnmeldungFenster").style.display = "block"
    }
</script>

<!-- Inventarsucher -->
<script>
    var GesamteBeuteAuflistungInventarSucher = [];

    var Ladezeichen_Inventarsucher = document.getElementById("Ladezeichen_Inventarsucher");
    var Bedienoberflaeche_Inventarsucher = document.getElementById("Bedienoberflaeche_Inventarsucher");
    var RadioButtonSucheNachInventarnummer = document.getElementById("RadioButtonSucheNachInventarnummer");
    var RadioButtonSucheNachArtikel = document.getElementById("RadioButtonSucheNachArtikel")
    var Suchtext_Inventarsucher_TextBox = document.getElementById("Suchtext_Inventarsucher_TextBox");
    var Suchergebnisse_Ueberschrift_Inventarsucher = document.getElementById("Suchergebnisse_Ueberschrift_Inventarsucher");
    var Suchergebnisse_Inventarsucher = document.getElementById("Suchergebnisse_Inventarsucher");

    function InventarsucherInit()
    {
        if(IstAngemeldet)
        {
            (async () =>
            {                         
                var AnzahlBeuteBereitsGefunden = 0;
                var AnzahlBeuteGesamt = 0;

                Inventarsucher_SucheZuruecksetzen();        
                Ladezeichen_Inventarsucher.style.display = "block";
                Bedienoberflaeche_Inventarsucher.style.display = "none";

                (async () =>
                {                 
                    var AlleEinsaetze = await GetSubvariablen("eintraege");
                    
                    AlleEinsaetze.forEach((EinsatzPfad, n) =>
                    {                              
                        (async () =>
                        {                      
                            var AlleArtikel = await GetSubvariablen(`${EinsatzPfad}/artikelListe`);
                            AnzahlBeuteGesamt += AlleArtikel.length;

                            var datum = await GetVariable(`${EinsatzPfad}/datum`)
                            var herkunft = await GetVariable(`${EinsatzPfad}/herkunft`)

                            AlleArtikel.forEach((ArtikelPfad, n) =>
                            {                  
                                (async () =>
                                {                 
                                    var beschreibung = await GetVariable(`${ArtikelPfad}/beschreibung`)
                                    var inventarnummer = await GetVariable(`${ArtikelPfad}/inventarnummer`)
                                    var name = await GetVariable(`${ArtikelPfad}/name`)
                                    var zustand = await GetVariable(`${ArtikelPfad}/zustand`)

                                    var BeuteBeschreibung =
                                    {
                                        beschreibung: beschreibung,
                                        inventarnummer: inventarnummer,
                                        herkunft: herkunft,
                                        name: name,
                                        zustand: zustand,
                                        ArtikelPfad: ArtikelPfad,
                                        datum: datum,
                                    }

                                    GesamteBeuteAuflistungInventarSucher.push(BeuteBeschreibung);
                                    
                                    AnzahlBeuteBereitsGefunden ++;

                                    if(AnzahlBeuteBereitsGefunden == AnzahlBeuteGesamt)
                                    {
                                        SucheInitAbgeschlossenIntern();
                                    }
                                })()
                            })
                        })()                   
                    })                    
                })()     

                function SucheInitAbgeschlossenIntern()
                {

                    Ladezeichen_Inventarsucher.style.display = "none";
                    Bedienoberflaeche_Inventarsucher.style.display = "block";
                    Event_Inventarsucher_InitAbgeschlossen();
                }
            })()            
        }
    }

    function Inventarsucher_SucheZuruecksetzen()
    {
        Suchergebnisse_Inventarsucher.innerHTML = '';
        Suchtext_Inventarsucher_TextBox.value = '';
        Suchergebnisse_Ueberschrift_Inventarsucher.innerHTML = 'Suchergebnisse: (0)';
        Suchergebnisse_Inventarsucher.innerHTML = 'Bitte Suchtext eingeben ...';        

        if(RadioButtonSucheNachInventarnummer.checked)
        {
            document.getElementById("QRSCAN_Button_Suche").disabled = false
        }
        else
        {
            document.getElementById("QRSCAN_Button_Suche").disabled = true
        }
    }

    function Event_Inventarsucher_InitAbgeschlossen()
    {
        RadioButtonSucheNachInventarnummer.checked = true;
        RadioButtonSucheNachArtikel.checked = false;
    }

    function Suchtext_Inventarsucher_TextChanged()
    {        
        var SucheNachInventarnummer = RadioButtonSucheNachInventarnummer.checked;
        Suchergebnisse_Inventarsucher.innerHTML = "Suchergebnisse werden geladen ...";

        var Suchtext = Suchtext_Inventarsucher_TextBox.value.toLowerCase().replace("ä", "ae").replace("ö", "oe").replace("ü", "ue");
        var AnzahlSuchergebnisse = 0;

        if(Suchtext != "")
        {
            GesamteBeuteAuflistungInventarSucher.forEach((Beute, n) =>
            {
                if(SucheNachInventarnummer)
                {
                    if(Beute.inventarnummer != "")
                    {
                     

                        if(Beute.inventarnummer.toString().toLowerCase().replace("ä", "ae").replace("ö", "oe").replace("ü", "ue").includes(Suchtext))
                        {
                            AnzahlSuchergebnisse += 1;
                            AddBeuteZurAuflistung_InventarSucher(Beute);
                        }
                    }
                }
                else
                {
                    if(Beute.name != "")
                    {
                        if(Beute.name.toString().toLowerCase().includes(Suchtext) ||
                        Beute.beschreibung.toString().toLowerCase().replace("ä", "ae").replace("ö", "oe").replace("ü", "ue").includes(Suchtext) ||
                        Beute.datum.toString().toLowerCase().replace("ä", "ae").replace("ö", "oe").replace("ü", "ue").includes(Suchtext))
                        {
                            AnzahlSuchergebnisse += 1;
                            AddBeuteZurAuflistung_InventarSucher(Beute);
                        }
                    }
                }
            })
        }
        else
        {
            Suchergebnisse_Inventarsucher.innerHTML = "Bitte Suchtext eingeben ...";
        }     


        if(Suchergebnisse_Inventarsucher.innerHTML == "Suchergebnisse werden geladen ...")   
        {
            Suchergebnisse_Inventarsucher.innerHTML = '<img src="https://i.imgur.com/EELyqbg.png" width="50px" alt=""><strong class="ml-2">Keine Suchergebnisse gefunden</strong>';
        }

        Suchergebnisse_Ueberschrift_Inventarsucher.innerHTML = `Suchergebnisse: (${AnzahlSuchergebnisse})`;
        
    }

    function AddBeuteZurAuflistung_InventarSucher(BeuteObjekt)
    {
        if(Suchergebnisse_Inventarsucher.innerHTML == "Suchergebnisse werden geladen ...")   
        {
            Suchergebnisse_Inventarsucher.innerHTML = "";
        }

        Suchergebnisse_Inventarsucher.innerHTML += `
        <div style="background-color: rgb(70, 70, 70); border-radius: 10px; padding: 15px;">
            <strong style="font-size: x-large; color: white;"><img src="https://i.imgur.com/jvYVQhc.png" class="mr-2" height="26px" alt="">${BeuteObjekt.name}</strong><br><br>     
            <strong>Herkunft</strong>: ${BeuteObjekt.herkunft == "" ? "Herkunft unbekannt" : `HGEG-${BeuteObjekt.herkunft.toUpperCase()}`}<br>
            <strong>Datum</strong>: ${BeuteObjekt.datum}<br>
            <strong>Inventarnummer</strong>: ${BeuteObjekt.inventarnummer == "" ? "Keine Inventarnummer" : BeuteObjekt.inventarnummer}<br><br>
            <strong>Beschreibung</strong>:<br>${BeuteObjekt.beschreibung == "" ? "Keine Beschreibung" : BeuteObjekt.beschreibung}<br>
            <br>
            <strong>Zustand</strong>: ${BeuteObjekt.zustand}<br><br>
            <button type="button" onclick="ArtikelBearbeiten_Seite_Oeffnen('${BeuteObjekt.ArtikelPfad}')" class="btn btn-primary">Bearbeiten</button>
        </div>
        <br> `
    }
</script>

<!-- Eintrag hinzufuegen -->
<script>
    function EintragSpeichern_BeuteHinzufuegenSeite_ButtonClicked()
    {
        (async () =>
        {                 
            var EindeutigeKennung = new Date().getTime();
            
            var Anmerkungen = document.getElementById("AnmerkungenTextBox").value;
            var GolM = document.getElementById("MarianAnwesendCheckBox").checked;
            var KoeA = document.getElementById("AndreasAnwesendCheckBox").checked;
            var KoeM = document.getElementById("KoeckMarkusAnwesendCheckBox").checked;
            var UntM = document.getElementById("MarkusAnwesendCheckBox").checked;

            var datum = formatDate(new Date(document.getElementById("AusgewaehltesDatumEintragHinzufuegen").value));
            var herkunft = document.getElementById("herkunftCombobox").value;

            var AuflistungBeute_EintragHinzufuegen = document.getElementById('AuflistungBeute_EintragHinzufuegen');
            var elemente = AuflistungBeute_EintragHinzufuegen.children;

            if(!(!GolM && !KoeA && !KoeM && !UntM))
            {
                if(!herkunft.includes("Bitte"))
                {
                    var AllePromises = [];    

                    AllePromises.push(
                    (async () =>
                    {                 
                        await SetVariable(`eintraege/${EindeutigeKennung}/Anmerkungen`, Anmerkungen);
                        await SetVariable(`eintraege/${EindeutigeKennung}/datum`, datum);
                        await SetVariable(`eintraege/${EindeutigeKennung}/herkunft`, herkunft);

                        await SetVariable(`eintraege/${EindeutigeKennung}/GolM`, GolM);
                        await SetVariable(`eintraege/${EindeutigeKennung}/KoeA`, KoeA);
                        await SetVariable(`eintraege/${EindeutigeKennung}/KoeM`, KoeM);
                        await SetVariable(`eintraege/${EindeutigeKennung}/UntM`, UntM);                        
                    })())

                    if(!AuflistungBeute_EintragHinzufuegen.innerHTML.includes("Noch keine Beute"))
                    {
                        Array.from(elemente).forEach(element =>
                        {      
                            console.log(element);
                            var id = element.id;
                            var name = document.getElementById(id).getAttribute("name");
                            var i = document.getElementById(id).getAttribute("i");
                            var inventarnummer = document.getElementById(`inventarnummer_${id}`).value;
                            var beschreibung = document.getElementById(`beschreibung_${id}`).value;
                            var zustand = document.getElementById(`zustand_${id}`).value;
                            
                            AllePromises.push(
                            (async () =>
                            {                 
                                await SetVariable(`eintraege/${EindeutigeKennung}/artikelListe/${i}/beschreibung`, beschreibung);
                                await SetVariable(`eintraege/${EindeutigeKennung}/artikelListe/${i}/inventarnummer`, inventarnummer);
                                await SetVariable(`eintraege/${EindeutigeKennung}/artikelListe/${i}/name`, name);
                                await SetVariable(`eintraege/${EindeutigeKennung}/artikelListe/${i}/zustand`, zustand);
                            })())                                                                  
                        });
                    }
                    
                    await Promise.all(AllePromises);

                    location.reload();
                }
                else
                {
                    alert("Keine Organisation ausgewählt!")
                }            
            }
            else
            {
                alert("Mindestens 1 Person muss teilnehmen!");
            }        
        })()        
    }

    var EintragHinzufuegen_Aktuelles_i = 1;

    function BeuteHinzufuegenButtonClicked()
    {
        if(IstAngemeldet)
        {
            
            var AuflistungBeute_EintragHinzufuegen = document.getElementById("AuflistungBeute_EintragHinzufuegen");
            var Anzahl = document.getElementById("AnzahlArtikelBeuteHinzufuegenTextBox").value;      
            var name = document.getElementById("BezeichnungArtikelBeuteHinzufuegenTextBox").value;
            
            document.getElementById("AnzahlArtikelBeuteHinzufuegenTextBox").value = "1";
            document.getElementById("BezeichnungArtikelBeuteHinzufuegenTextBox").value = "";

            if(Anzahl != "" && Anzahl != "0" && Anzahl != 0 && name != "" && !Anzahl.includes(";") && !name.includes(";"))
            {
                if(AuflistungBeute_EintragHinzufuegen.innerHTML.includes("Noch keine Beute")) { AuflistungBeute_EintragHinzufuegen.innerHTML = "" }

                for (var i = 1; i <= Anzahl; i++)
                {
                    var id = `${name}_${EintragHinzufuegen_Aktuelles_i}_BeuteHinzufuegenAuflistung`


                    //AuflistungBeute_EintragHinzufuegen.insertAdjacentHTML('beforeend', `<div name="${name}" i="${EintragHinzufuegen_Aktuelles_i}" id="${id}"><strong>${name}</strong> - Beschreibung: <input type="text" id="beschreibung_${id}"> Zustand: ${selectTagZustand} InvNr: <input type="text" id="inventarnummer_${id}"> <button id="Entfernen" onclick="document.getElementById('inventarnummer_${id}').value = '00000000'">0</button><button id="Entfernen" onclick="document.getElementById('${id}').remove()">Entfernen</button><br><br></div>`)

                    AuflistungBeute_EintragHinzufuegen.insertAdjacentHTML('beforeend', 
                    `
                    <div style="border: 1px solid #ccc; border-radius: 5px; padding: 10px;" name="${name}" i="${EintragHinzufuegen_Aktuelles_i}" id="${id}">
                        <strong style="font-size: x-large;"> ${name}</strong><br><br>

                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon3" style="width: 120px;">Beschreibung</span>
                            </div>
                            <input type="text" class="form-control" id="beschreibung_${id}" aria-describedby="basic-addon3">
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon3" style="width: 120px;">InventarNr</span>
                            </div>
                            <input type="number" class="form-control" id="inventarnummer_${id}" aria-describedby="basic-addon3">                      
                        </div>
                        
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="inputGroupSelect01" style="width: 120px;">Zustand</label>
                            </div>
                            <select class="custom-select" id="zustand_${id}">
                                <option value="Unbekannt">Unbekannt</option>
                                <option value="Funktioniert">Funktioniert</option>
                                <option value="FunktioniertTeilweise">FunktioniertTeilweise</option>                                    
                                <option value="Defekt">Defekt</option>
                            </select>
                        </div>
                        
                        <button class="btn btn-danger" style="width: 118px;" id="Entfernen" onclick="document.getElementById('${id}').remove()"><img src="https://i.imgur.com/Rj1vuiK.png" class="mr-2" height="22px" alt="">Löschen</button> 
                        <button class="btn btn-light" onclick="document.getElementById('inventarnummer_${id}').value = '00000000'"><img src="https://i.imgur.com/F0aGYuh.png" class="mr-2" height="22px" alt="">0</button> 
                        <button class="btn btn-light" onclick="ReadQRCode('inventarnummer_${id}', false)"><img src="https://i.imgur.com/TONSd5l.png" class="mr-2" height="22px" alt="">InvNr-Scan</button><br>
                    </div> `
                    
                    )


                    EintragHinzufuegen_Aktuelles_i++;
                }

            }
            else
            {
                alert("Fehlerhafte Eingaben!");
            }
        }
    }
</script>

<!-- Einsaetze auflisten -->
<script>
    var currentDate = new Date();
    var currentDateFormatted = formatDate(currentDate)
    
    document.getElementById('AusgewaehltesDatum').value = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(currentDate.getDate()).padStart(2, '0')}`;
    document.getElementById('AusgewaehltesDatumEintragHinzufuegen').value = document.getElementById('AusgewaehltesDatum').value;
    var FlowLayoutPanel_Einsatzauflistung = document.getElementById("FlowLayoutPanel_Einsatzauflistung")



    function ButtonEinsaetzeAnzeigenClicked()
    {
        if(IstAngemeldet)
        {
            TagAuflistungAktualisieren();
        }
    }

    function ClearFlowLayoutPanel_Einsatzauflistung()
    {
        FlowLayoutPanel_Einsatzauflistung.innerHTML = "";
    }

    

    function TagAuflistungAktualisieren()
    {
        if(IstAngemeldet)
        {
            var NeueDIVs = [];

            var AusgewaehltesDatumInhalt = formatDate(new Date(document.getElementById('AusgewaehltesDatum').value));

            FlowLayoutPanel_Einsatzauflistung.innerHTML = '<div class="spinner-border text-secondary" role="status" style="text-align: center;"></div><br><br>Einsätze werden geladen ...';
            
            (async () =>
            {                 
                var AlleEinsaetze = await GetSubvariablen("eintraege");
                
                var promiseArray0 = [];

                AlleEinsaetze.forEach((EinsatzPfad, n) =>
                {                                 
                    promiseArray0.push(   
                    (async () =>
                    {      
                        var DatumDesEinsatzes = await GetVariable(`${EinsatzPfad}/datum`);
                        
                        if(DatumDesEinsatzes == AusgewaehltesDatumInhalt)
                        {                            
                            var AnwesendePersonen = "";   
                            if(await GetVariable(`${EinsatzPfad}/UntM`)) {AnwesendePersonen += "Markus "}
                            if(await GetVariable(`${EinsatzPfad}/KoeA`)) {AnwesendePersonen += "Andreas "}
                            if(await GetVariable(`${EinsatzPfad}/KoeM`)) {AnwesendePersonen += "KoeckMarkus "}
                            if(await GetVariable(`${EinsatzPfad}/GolM`)) {AnwesendePersonen += "Marian "}

                            var Anmerkungen = await GetVariable(`${EinsatzPfad}/Anmerkungen`);
                            if(Anmerkungen == ""){Anmerkungen = "KEINE"}
                            
                            var BeuteString = "";

                            var AlleBeute = await GetSubvariablen(`${EinsatzPfad}/artikelListe`);

                            var promiseArray = [];
                            AlleBeute.forEach((BeutePfad, n) =>
                            {
                                promiseArray.push(
                                (async () =>
                                {          
                                    //var beschreibung = await GetVariable(`${BeutePfad}/beschreibung`)      
                                    var inventarnummer = await GetVariable(`${BeutePfad}/inventarnummer`) 
                                    var name = await GetVariable(`${BeutePfad}/name`)
                                    var zustand = await GetVariable(`${BeutePfad}/zustand`)                                    
                                    
                                    zustand = `(${zustand})`

                                    if(inventarnummer != "")
                                    {
                                        inventarnummer = `: <span style="color: rgb(255,255,255);"><strong>${inventarnummer}</strong></span>`;
                                    }

                                    if(zustand == "" || zustand == "(Unbekannt)")
                                    {
                                        zustand = "";
                                    }

                                    BeuteString += 
                                    `- ${name}${inventarnummer} ${zustand}<br>`
                                    
                                })())
                                
                            })

                            await Promise.all(promiseArray);
                            promiseArray = []

                            var Hintergrundfarbe = "rgb(44, 97, 68)";

                            if(BeuteString == "")
                            {
                                Hintergrundfarbe = "rgb(200, 97, 68)";
                                BeuteString = "Keine Beute";
                            }
              
                            NeueDIVs.push(
                                `<div style="background-color: ${Hintergrundfarbe}; border-radius: 10px; padding: 15px;">
                                <strong style="font-size: x-large;">HGEG-${await GetVariable(`${EinsatzPfad}/herkunft`)} am ${DatumDesEinsatzes}</strong><br>      
                                Anmerkungen: ${Anmerkungen}<br>
                                Anwesend: ${AnwesendePersonen}<br><br>
                
                                <strong>Beute:</strong><br>
                                ${BeuteString}
                                </div>
                                <br>`
                            );
                                                    
                        }
                    })())                                                        
                });

                await Promise.all(promiseArray0);
                promiseArray0 = []

                FlowLayoutPanel_Einsatzauflistung.innerHTML = "";

                for (var neuesDIV of NeueDIVs)
                {
                    FlowLayoutPanel_Einsatzauflistung.innerHTML += neuesDIV;
                }

                if(FlowLayoutPanel_Einsatzauflistung.innerHTML == "")
                {
                    FlowLayoutPanel_Einsatzauflistung.innerHTML = '<img src="https://i.imgur.com/EELyqbg.png" width="50px" alt=""><strong class="ml-2">Kein Einsatz an diesem Tag</strong>';
                }

            })()
        }        
    }

        
</script>

<script src="https://unpkg.com/html5-qrcode"></script>

<!-- QRSCAN -->
<script>
    var ScrollPositionVorQRSCAN = 0;
    var qrCodeScanner;

    function ReadQRCode(WohinSchreiben, SucheDanachStarten, QRScanUeberschriftText)
    {
        ScrollPositionVorQRSCAN = window.scrollY;

        if(QRScanUeberschriftText != "" && QRScanUeberschriftText != undefined && QRScanUeberschriftText != null)
        {
            e("QRScanUeberschriftText").innerHTML = QRScanUeberschriftText
        }
        else
        {
            e("QRScanUeberschriftText").innerHTML = "QR-CODE SCAN"
        }

        document.getElementById("QRSCAN").style.display = "block"
        document.getElementById("GesamteWebseite").style.display = "none"

        qrCodeScanner = new Html5Qrcode('qr-code-reader');

        qrCodeScanner.start(
            {
                facingMode: 'environment'
            },

            {
                fps: 5,
                qrbox: 200
            },

            qrCodeMessage =>
            {
                var QRCodeString = qrCodeMessage;

                if(WohinSchreiben == "FzgBarcodeScanZwischenablage")
                {
                    FahrzeugSuchenMitBarcode(QRCodeString)
                }
                else
                {
                    document.getElementById(WohinSchreiben).value = QRCodeString;
                }
                

                if(SucheDanachStarten)
                {
                    Suchtext_Inventarsucher_TextChanged();
                }

                document.getElementById("QRSCAN").style.display = "none"
                document.getElementById("GesamteWebseite").style.display = "block"

                window.scrollTo(0, ScrollPositionVorQRSCAN);

                qrCodeScanner.stop();
            },

            errorMessage =>
            {
                //console.error(errorMessage);
            }
        );
    }

    function QRSCAN_Abbrechen()
    {
        qrCodeScanner.stop();

        document.getElementById("QRSCAN").style.display = "none"
        document.getElementById("GesamteWebseite").style.display = "block"
        window.scrollTo(0, ScrollPositionVorQRSCAN);
    }

    function WartungsberichtSchliessen()
    {
        document.getElementById("Wartungsberichte_Seite").style.display = "none"
        document.getElementById("GesamteWebseite").style.display = "block"
        window.scrollTo(0, ScrollPositionVorQRSCAN);
    }
	
</script>

<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/barcodes/JsBarcode.code128.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.4.1/jspdf.debug.js"></script>

<!-- CodeGenerator -->
<script>
    var canvas = document.getElementById("CodeGeneratorCanvas");

    function Event_CodeGenerator_Load()
    {               
        var barcode_element = document.getElementById('barcode');
        var context = canvas.getContext('2d');
        canvas.width = 7 * 180 + 1;
        canvas.height = 16 * 104 + 1;

        context.fillStyle = 'black';
        context.fillRect(0, 0, canvas.width, canvas.height);

        for (let i = 0; i < 7; i++)
        {
            var x = 1 + 180 * i;
            
            for (let j = 0; j < 16; j++)
            {
                var y = 1 + 104 * j;

                var NeueNummer = "";

                for (let n = 0; n < 8; n++)
                {
                    var randomNumber = Math.floor(Math.random() * 10);
                    NeueNummer += randomNumber;
                }
                
                DrawImage(NeueNummer, x, y);            
            }      
        }       

        barcode_element.style.display = 'none';
        canvas.style.display = 'none'


        function DrawImage(Nr, x, y)
        {
            var Nr_String = ""

            for (let index = 0; index < 8; index++)
            {
                Nr_String += Nr[index]
                if(index == 1 || index == 3 || index == 5)
                {
                    Nr_String += "  "
                }

            }
            
            JsBarcode("#barcode", Nr,
            {
                format: "CODE128",
                lineColor: "#00",
                width: 2,
                height: 60,
                displayValue: true
            });

            var svgURL = 'data:image/svg+xml,' + encodeURIComponent(new XMLSerializer().serializeToString(barcode_element));
            var img = new Image();
            img.onload = function()
            {
                context.drawImage(img, x, y);

                context.fillStyle = "#FFFFFF"
                context.fillRect(x + 30, y + 70, 105, 25)
                
                context.font = "bold 23px Arial";
                context.fillStyle = "#000000";
                context.fillText(Nr_String, x+18, y+95);
            };
            img.src = svgURL;
        }     
    }

    function GetDateTimeFormal()
    {
        var d = new Date();

        return `${d.getFullYear()}${String(d.getMonth() + 1).padStart(2, '0')}${String(d.getDate()).padStart(2, '0')}_${String(d.getHours()).padStart(2, '0')}${String(d.getMinutes()).padStart(2, '0')}`
    }

    function Download_BarcodePDF()
    {
        var doc = new jsPDF();

        var imgData = canvas.toDataURL('image/png');
        doc.text(`HGEG INV.NR BARCODES (EXPORTIERT: ${GetDateTimeFormal()})`, 5, 12);
        doc.addImage(imgData, 'PNG', 5, 297 - 277 - 5, 200, 277 - 5);

        doc.save(`HGEG_InvNr_${GetDateTimeFormal()}.pdf`);
    }
</script>
